[
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "My Blog",
    "section": "",
    "text": "It’s so fluffy I am gonna die!\n\n\n\nBirding\n\n\nAppledore\n\n\n\nMy 2024 adventures with fluffballs. A 7 minute read.\n\n\n\nJonathan Dain\n\n\nJul 8, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nPhylogenetic Resources\n\n\n\nphylogenetics\n\n\n\nMy curated list of resources for Bayesian phylogenetic and phylodynamic analysis\n\n\n\nJonathan Dain\n\n\nJun 27, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nHark! The Gulls of Appledore!\n\n\n\nBirding\n\n\nAppledore\n\n\n\nMy 2024 adventures in adult gull wrangling on Appledore. A 5 minute read.\n\n\n\nJonathan Dain\n\n\nMay 31, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMortality to HPAI and Trees\n\n\n\nanalysis\n\n\nphylogenetics\n\n\n\nA Short R document detailing a analysis on HPAI and mortality from a phylogenetic standpoint\n\n\n\nJonathan Dain\n\n\nApr 30, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBoston City Nature Challenge\n\n\n\nBirding\n\n\n\nMy first blog post to this new site, detailing the events of the Boston City Nature Challenge\n\n\n\nJonathan Dain\n\n\nApr 29, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nA New Year…\n\n\n\nThoughts\n\n\n\nReposting old blogs from previous website.\n\n\n\nJonathan Dain\n\n\nJan 9, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nThem Are Ducks….\n\n\n\nNantucket\n\n\n\nReposting old blog posts from previous website. This post details a summer Nantucket trip\n\n\n\nJonathan Dain\n\n\nJun 15, 2023\n\n\n\n\n\n\n\n\n\n\n\n\nBig Day Boston 2023\n\n\n\nBirding\n\n\n\nReposting my older posts from the previous blog here. This post is about the the Big Day Boston Birding event in 2023\n\n\n\nJonathan Dain\n\n\nMay 17, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe UMB Field Station\n\n\n\nNantucket\n\n\n\nReposting my older posts from the previous blog here. This post is about the UMB field station.\n\n\n\nJonathan Dain\n\n\nJan 20, 2023\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to The Duck Tapes",
    "section": "",
    "text": "Welcome, I am so glad you are here!\n\n\n\nA Great Black-Back Gull in an Island Sunrise\n\n\nPlease feel free to take a look around. Blog posts about my research can be found under the “My Blog” tab. Check out the “About Me” page to get to know me. “Photos” has a collection of fun pictures from the beautiful places that “virus-hunting” has taken me. Finally, the “Extras” page has a collection of links and posts from other areas of my life some of which are non-research related.\nHope to see you around sometime and if you are in the Massachusetts area, I’d love to grab a coffee."
  },
  {
    "objectID": "Blog_Posts/2024-01-09/2024-01-09.html",
    "href": "Blog_Posts/2024-01-09/2024-01-09.html",
    "title": "A New Year…",
    "section": "",
    "text": "A Great Black-Backed Gull from Appledore Island\n\n\nGood Morning Friends and Happy New Year!\nThe new year can bring with it a myriad of emotions, sometimes both positive and negative. Depending on where you are the new year can mean the start of winter or it can mean the start of a new exciting routine. Often though it just represents a new opportunity. My wife mentioned to me recently that she does not “get” the “new-year-new-me” trend because if someone wanted to change how they lived why not just start immediately rather than wait till the new year. It is an interesting “habit” that most of us have to make these new year’s changes, but I think it stems from this idea that when one calendar year closes another opens with an opportunity to make it different than the last.\nI started this new year with several goals in mind, one of them being to be more active on this blog for example. Now I use the term goal instead of resolution because I want it to be something that I am aiming towards, a new “identity” if you will. This would be opposed to a resolution that often feels very legalistic to me and seems to try to change the individual by focusing solely on the outcome rather than the driver of our actions. I want to be someone who writes, rather than making a rule over myself to write on some fixed schedule. It’s a slight difference but I maintain that inward change leads outward but not the inverse.\nNow this is a research blog so why am I talking about the new year and goals? Well, over the next several blog posts I will be outlining the major steps and ideas that are shaping how I am currently thinking about my research. It is my goal to do this for several reasons but the primary two are; one as I start writing my dissertation I will need to write anyway and this will allow me to write about my work in a much different style than scientific literature, and two I get to share it with you which is fun in and of itself.\nI hope that this new year is full of great opportunities for you to build better habits, change a mindset, write that paper, text that friend, or do any of the other things we as humans need to do. Most of all I hope you take the time to be intentional and seize the chance to change. There is no time like the present and as one of my best friends says, “The time will pass anyway whether I want it to or not so might as well make the most of it”.\nUntil next time keep your eyes to the sky\nCheers, Jonathan"
  },
  {
    "objectID": "Blog_Posts/2023-05-17/2023-05-17.html",
    "href": "Blog_Posts/2023-05-17/2023-05-17.html",
    "title": "Big Day Boston 2023",
    "section": "",
    "text": "Yours truly at the Boston Public Garden during Big Day Boston 2023\n\n\nI just moved to Boston last August and got into “Birding” as part of my Ph.D. at UMASS Boston studying Avian Influenza transmission. Since then I have been birding almost daily and increasing my understanding of the amazing world of Ornithology.\nI was really excited to see that there was a local birding event near where I was that was dedicated to the joyful task of seeing birds in your own backyard. It was an amazing day to have an event as well, given that the weather was just starting to turn and it was warm and sunny. To make it even more special I had just gotten an alert from Cornell that there was supposed to be a mass migration of birds(mostly passerines) in the days leading up to the event. All of this equated to one very happy #BirdNerd.\nAmanda (my wife) and I got there and met the hosts briefly before locking our eyes on the sky. They were incredibly nice people and even had a screen printing station with their custom logo! Their love for birds was on full display and it was an honor to be part of their inaugural birding event.\nAs for the reason for all our excitement………our feathery friends we saw so many wonderful species including my favorite bird the Common Loon (Gavia immer), who was in full breeding plumage and eating crabs in the wharf. Side note did you know loons have solid bones! Thats pretty wild for a bird that still has to fly relatively long distances! I walked away from this event with 24 total species, three of which were lifers (Black and White Warbler, Blue-Grey Gnatcatcher, and Common Tern), and better still a greater appreciation of Boston’s local avian biodiversity.\nHuge thank you for all the work that went into setting up this event and I can’t wait for next year. Here is a link to my eBird Trip report if you want to see all the species I saw. Until next time keep your eyes to the sky!\nCheers, Jonathan Dain\n\n\n\n\n\n\nMy Field Guide and BigDayBoston Checklist\n\n\n\n\n\n\n\nRepping their screen printed shirt!\n\n\n\n\n\n\n\n\n\nMomma Robin incubating some eggs"
  },
  {
    "objectID": "Blog_Posts/2024-04-29/2024-04-29.html",
    "href": "Blog_Posts/2024-04-29/2024-04-29.html",
    "title": "Boston City Nature Challenge",
    "section": "",
    "text": "The City Nature Challenge is a fun worldwide collaborative bio-blitz with cities across the world to observe the most species (April 26 - April 29) and then ID them (April 30 - May 6)! We’ll be documenting urban biodiversity within the I-495 corridor, out to Stellwagen Bank, including Cape Cod and islands. It’s simple, it’s fun, and it contributes to scientific data helping to better understand our world and our non-human neighbors!\n.\nCopied from -&gt; https://www.bostoncnc.org/\n\nCitizen science is an amazing movement that is becoming increasingly more and more impactful as the years go by. Just look at the number of publications with the keyword “citizen science” over the years.\n\nYet how do we actually define citizen science?\nCitizen science is a very broad term that can have many nuances depending on who you talk with. However a very simple definition that I am quite fond of is as follows:\n\n“Citizen science broadly refers to the active engagement of the general public in scientific research tasks. Citizen science is a growing practice in which scientists and citizens collaborate to produce new knowledge for science and society.” (Vohland et al. 2021)\n\nI like this definition for two reasons:\n\nIt calls out the fact that there is a need to engage the public in research. Putting the task of “engaging” back on the scientist. In other words scientists need to be mindful of how they are engaging the community.\nIt speaks to the fact that there is a collaboration where both parties gain something, rather than a just a single researcher gaining new data for their project.\n\nSo now that we have a working definition of citizen science lets talk about the Boston City Nature Challenge! This past weekend there was a concentrated effort by scientists and the public alike to go out and catalog the biodiversity of the greater Boston area over the course of three days. As I am writing this there are currently 11,276 observations, representing 1,589 species (141 of which are birds in case you were curious). All of this was contributed by 1,227 observers. When you put this in context that this was just over the course of four days that is an amazing number of species seen. Especially since alot of these are not “professional” researchers going out to sample their focal taxa!\nBy the way 23 of those observations were mine :)\nThe best part of this is that you too can participate in something like this through the use of your own cellphone! You don’t need the fanciest piece of camera equipment to go and capture the local diversity. The tools to aid in the understanding of our natural world are in your hands, or at least they can be!\nIt is just the click of a few buttons to get the app here\nYou might be wondering at this point what I actually saw during this event right? Well I had the privilege to work with a group of other students to survey the Harbor Islands here in Boston for birds. We went out early in the morning last Friday in a boat around the islands. Part of our team was interested in the seal population, however I wanted to highlight the amazing avian biodiversity on these islands. In total we saw over 16 species of birds. Below are some of my photos, I hope that you enjoy them as much as I do.\n\n\n\nA Herring Gull\n\n\n\n\n\nA Common Eider\n\n\n\n\n\nAnother Common Eider\n\n\n\n\n\nAn American Oystercather in Flight\n\n\n\n\n\nSurf Scoters in Flight\n\n\nIf you want to see more pictures from the Boston City Nature challenge you can view them all here, which is the same link as above.\nIf you want to see more of my photos and citizen science you can see my eBird account and my iNaturalist account for more.\nI hope you have a fantastic day and as always keep your eyes to the sky!\nCheers, Jonathan Dain\n\nReferences:\n\n\n\nA Herring Gull\nA Common Eider\nAnother Common Eider\nAn American Oystercather in Flight\nSurf Scoters in Flight\n\n\n\n\nReferences\n\nVohland, Katrin, Anne Land-Zandstra, Luigi Ceccaroni, Rob Lemmens, Josep Perelló, Marisa Ponti, Roeland Samson, and Katherin Wagenknecht, eds. 2021. The Science of Citizen Science. Cham: Springer International Publishing. https://doi.org/10.1007/978-3-030-58278-4."
  },
  {
    "objectID": "Blog_Posts/2023-06-15/2023-06-15.html",
    "href": "Blog_Posts/2023-06-15/2023-06-15.html",
    "title": "Them Are Ducks….",
    "section": "",
    "text": "Yours truly holding a duckling\n\n\n\n\n\n\n\nSwabbing a duckling\n\n\n\n\n\nThis comedic line from the movie ‘Monty Python and the Holy Grail’ flashed in my head, as I pulled this beautiful male mallard from the clover leaf trap so it could be sampled and released again. We were back on Nantucket this past week to monitor the local waterfowl population for avian influenza, specifically highly pathogenic avian influenza. We had been watching a group of about 100 ducks swim in this small pond, Consue Springs, in the middle of this quaint Island town. Having set up the traps that morning it was a waiting game as the tide receded, exposing more of the corn ‘kibble’ in the center of these one way heart-shaped traps along the edge of the water. All the ducks had to do was swim into the trap for a tasty meal, and then of course donate a few swabs and some blood to science but the meal is the more attractive factor here.\nIt was already midday when the first MALL (the American Birding Association four-letter code for Mallards) finally wiggled his way into the gold mine of corn. Now our lab has this saying that ‘birds begat birds’ so we were going to let this individual encourage the others to swim into the trap with him. Pretty soon we had three more ducks swimming alongside him, so it was time to spring the trap. After some deft dip-netting and some iconic duck hand passes we had all four MALL’s inside our holding cage to begin processing.\nSo you might be wondering what ‘duck processing’ might consist of, well you came to the right blog to find out. Let’s zoom out a little bit first. Remember we are looking for avian influenza (AI) infections in these birds, virus hunting If you prefer.  AI infections are typically contained in the respiratory and GI tracts which means in order to see if these birds are actively shedding any live virus, we need samples from both ends of the bird. The business end i.e. the mouth and the ‘dirty’ end i.e. the cloaca. Bonus points if our new friends decide to use its handler as a restroom, we love a good fecal sample here. So yeah, we are taking oral and cloacal swabs to test for infection. But wait! There is more! We all just went through a global pandemic so probably the first thing you might think of when I say virus is SARS-COV-2, and the vaccine. Well, I also think of antibodies, which can be super helpful in telling us if this bird has had an infection to AI in the past since antibodies are specific to the infection they fight. Where do you get antibodies….that’s right blood samples and more specifically the serum fraction of blood. We also want a blood sample to look at gene expression but that will be its own post, for now, we are just taking a small blood sample to test for antibodies and expressed genes. Finally, we just take some simple morphometrics such as wing length, some beak measurements, and weight.\nAll in all, this takes about 10 to 15 minutes and then our feathered friend is back on the water to go eat some more tasty corn. The stunning male (or drake) MALL I pulled out of our trap did great and was back to swimming shortly. In total, we sampled ten adult ducks and two ducklings, which by the way are the cutest thing I have ever seen.\nIt is hard to explain the feeling of holding these magnificent animals knowing the weight of what you are doing. They are just so intricate and fascinating in their own right, their feathers for example are simply astonishing. This virus is truly a threat to the beauty of this world, it’s a privilege to be part of the solution. Until next time keep your eyes to the sky.\nCheers, Jonathan Dain\n\n\n\n\n\n\n\n\n\nMelba holding a MALL hen (female) while Connor and I dipnet the others\n\n\n\n\n\n\n\nThe team and I next to Melba’s beautiful sign.\n\n\n\n\n\n\n\n\n\nMan can’t beat this view! Our two water clover-leaf traps worked great and gave us ideas to improve them.\n\n\n\n\n\n\n\n\nMelba holding a MALL hen (female) while Connor and I dipnet the others"
  },
  {
    "objectID": "Blog_Posts/2023-01-20/2023-01-20.html",
    "href": "Blog_Posts/2023-01-20/2023-01-20.html",
    "title": "The UMB Field Station",
    "section": "",
    "text": "Field Biology is the name of the game when it comes to wild birds. You simply cannot hope to study the ecology of these birds from the inside of a brick building. You have to venture out into the woods, shores, and oceans to find them. They often don’t come to you, which means exploring quite challenging places, while the birds are 50 feet in the air, or floating atop the waves. You are often cold, wet, hungry, and in environments that more than a few people would consider “less than optimal”. Yet the moment you see one of these gulls, ducks, or finches soaring, bouncing, or flinting through the air, the reason why you are out there in the first place becomes clear. Today I want to tell you about the unique resource that UMB has at its disposal.\nSome of my preliminary research has taken me out of the university, where I am usually holed up reading the latest influenza paper, to the small island of Nantucket. Let me be the first to tell you this island is amazing, a short ferry ride and you are in a new world. First of all, it has this wonderful small fishing town atmosphere with beautiful buildings and amazing people. Secondly, this island is the home of so many different conservation groups. From the “Linda Loring Nature Foundation” to the “Marine Mammal Alliance Nantucket” there is a wide array of science happening on this relatively small crescent moon of land. Thirdly, the biodiversity of this island makes it an excellent place to study birds. There are so many places to get close to ducks and gulls in their native landscape.\nHowever, simply going to an Island with no support can make a trip much more challenging, which brings me to the main thrust of this post. UMASS Boston has the amazing privilege of having a field station located on the Island! Not only that but it is managed by one of the nicest people I have ever met, Yvonne. She has given so much of her time to the support of researchers like my lab and created an environment where science and conservation can flourish. I know the rest of my lab would agree in saying our research would not be possible without the field station and its amazing manager. Below is a picture of the view from the main window of the station and as you can see it’s quite stunning. One can see bufflehead ducks, herring gulls, and many more simply by sitting at this prime location.\nThe UMB Field Station January 20, 2023 Jonathan B Dain Field Biology is the name of the game when it comes to wild birds. You simply cannot hope to study the ecology of these birds from the inside of a brick building. You have to venture out into the woods, shores, and oceans to find them. They often don’t come to you, which means exploring quite challenging places, while the birds are 50 feet in the air, or floating atop the waves. You are often cold, wet, hungry, and in environments that more than a few people would consider “less than optimal”. Yet the moment you see one of these gulls, ducks, or finches soaring, bouncing, or flinting through the air, the reason why you are out there in the first place becomes clear. Today I want to tell you about the unique resource that UMB has at its disposal.\nSome of my preliminary research has taken me out of the university, where I am usually holed up reading the latest influenza paper, to the small island of Nantucket. Let me be the first to tell you this island is amazing, a short ferry ride and you are in a new world. First of all, it has this wonderful small fishing town atmosphere with beautiful buildings and amazing people. Secondly, this island is the home of so many different conservation groups. From the “Linda Loring Nature Foundation” to the “Marine Mammal Alliance Nantucket” there is a wide array of science happening on this relatively small crescent moon of land. Thirdly, the biodiversity of this island makes it an excellent place to study birds. There are so many places to get close to ducks and gulls in their native landscape.\nHowever, simply going to an Island with no support can make a trip much more challenging, which brings me to the main thrust of this post. UMASS Boston has the amazing privilege of having a field station located on the Island! Not only that but it is managed by one of the nicest people I have ever met, Yvonne. She has given so much of her time to the support of researchers like my lab and created an environment where science and conservation can flourish. I know the rest of my lab would agree in saying our research would not be possible without the field station and its amazing manager. Below is a picture of the view from the main window of the station and as you can see it’s quite stunning. One can see bufflehead ducks, herring gulls, and many more simply by sitting at this prime location.\n\n\n\nThe View from the UMB field station\n\n\nIf you want to learn more about the amazing things going on here on Nantucket at the UMB field station you can check it out on their Facebook page linked below. Until next time keep your eyes to the sky.\nLink to the Nantucket Field Station: https://www.facebook.com/NantucketFieldStation\nCheers, Jonathan"
  },
  {
    "objectID": "Blog_Posts/2024-04-30/2024-04-30.html",
    "href": "Blog_Posts/2024-04-30/2024-04-30.html",
    "title": "Mortality to HPAI and Trees",
    "section": "",
    "text": "A ‘short’ R script by Jonathan Dain.\nGoal: We want to understand the mortality rates in while birds due to HPAI and how it relates to the underlying phylogeny that connects bird species. So let’s dive in.\n\n\n\npacman::p_load(phytools,\n               ggplot2,\n               ggthemes,\n               tidyverse,\n               geiger,\n               knitr,\n               phangorn,\n               rethinking)\n\n\n\n\nOur data comes from multiple sources so I will load each one and give a brief overview of each. To start we need to get our raw data about mortality in wild birds due to HPAI. This data come from the USDA website. It is a collection of observations of HPAI in wild birds. Admittedly this is a very sparse dataset and I know that alot of their observations are oppourtunistic rather than focused searching….but its what we got so lets put it to work.\n\nraw_usda &lt;- read_csv(file = \"data/hpai-wild-birds (1).csv\")\n\nhead(raw_usda) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nState\nCounty\nCollection Date\nDate Detected\nHPAI Strain\nBird Species\nWOAH Classification\nSampling Method\nSubmitting Agency\n\n\n\n\nSouth Carolina\nColleton\n12/30/2021\n01/13/2022\nEA H5N1\nAmerican wigeon\nWild bird\nHunter harvest\nNWDP\n\n\nSouth Carolina\nColleton\n12/30/2021\n01/13/2022\nEA H5N1\nBlue-winged teal\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n12/30/2021\n01/12/2022\nEA H5N1\nNorthern shoveler\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5N1\nAmerican wigeon\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5\nGadwall\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5\nGadwall\nWild bird\nHunter harvest\nNWDP\n\n\n\n\n\nOk the other dataset that we will need is a species lookup file that I have made for replacing common names with species names. It takes as input a common name - often poorly spelled - and replaces it with the correctly spelled latin name. It can also add in some other useful bits which we will look at later.\n\nSpecies_Lookup &lt;- readRDS(file = \"/Users/jonathandain/My_Files/My_Code/Species_Lookup_Sheet/Species_Lookup_20240323.rds\")\n\nhead(Species_Lookup) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\nalt.common.name\ntype\nscientific.name\nenlish.name.ebird\norder\nfamily\n\n\n\n\nafrican crowned crane\nOther\nbalearica regulorum\ngray crowned-crane\ngruiformes\ngruidae (cranes)\n\n\namerican black duck\nDabbling duck\nanas rubripes\namerican black duck\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\namerican blue-winged teal\nDabbling duck\nspatula discors\nblue-winged teal\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\namerican coot\nOther\nfulica americana\namerican coot\ngruiformes\nrallidae (rails, gallinules, and coots)\n\n\namerican crow\nOther\ncorvus brachyrhynchos\namerican crow\npasseriformes\ncorvidae (crows, jays, and magpies)\n\n\namerican green-winged teal\nDabbling duck\nanas crecca\ngreen-winged teal\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\n\n\n\nFinally as you might be wondering we need a bird phylogenetic tree! Thankfully the hard work of actually producing a bird tree has been done for us by the lovely people at BirdTree, we just get to reap the benefits.\n\n# -&gt; allbirdtree &lt;- readRDS(file = \"data/allbirdtree.rds\")\n\n#' note this is a massive multiphylo object so it may take a smidge of time to load.\n#' I had to remove this due to size limits but those interested can email me for more detail. \n\nOk now that our data is loaded we can move onto some data wrangling. Which is the second most fun part of any research question.\n\n\n\nOk first we need to do some data wrangling to make this USDA data usable.let’s first deal with the getting a sense of the data and if these birds are alive or dead when sampled. In other words what is the disease phenotype.\n\n### make a copy of the data\nd &lt;- raw_usda |&gt; \n  mutate_all(.funs = tolower) #make the names lowercase\n\n### look at the sampling methods as levels\nlevels(as.factor(x = d$`Sampling Method`)) |&gt; kable(col.names = 'Sampling Method')\n\n\n\n\nSampling Method\n\n\n\n\nagency harvest\n\n\nhunter harvest\n\n\nlive bird\n\n\nmorbidity/mortality\n\n\n\n\n\nOk here lies one of the key assumptions I am going to make about this dataset. Given that the hunter harvested and agency harvested birds were likely out moving/behaving naturally prior to their “removal” I think it is fair to assume that these birds did not exhibit any symptomatic behavior of HPAI. That is also true for the live birds.\nThis is of course opposed to the birds in the “morbidity/mortality” group which likely did exhibit symptoms of HPAI.\nWe are going to want to label the two harvest and live bird methods as “healthy/alive birds” and then the mortality birds as ‘dead’.\n\n#to do that we need to get some indices. \nhunt &lt;- which(d$`Sampling Method`==\"hunter harvest\")\nlive &lt;- which(d$`Sampling Method`==\"live bird\")\nagent &lt;- which(d$`Sampling Method`==\"agency harvest\")\ndead &lt;- which(d$`Sampling Method`=='morbidity/mortality')\n\n#now we just need a status column\nd &lt;- d |&gt; \n  mutate(status=\"NA\")\n\n#now we can just manually change these to what we want. \nd$status[hunt] &lt;- \"alive\"\nd$status[live] &lt;- \"alive\"\nd$status[agent] &lt;- 'alive'\nd$status[dead] &lt;- \"symptomatic\"\n\n#just double check our work.\nlevels(as.factor(x = d$status)) \n\n[1] \"alive\"       \"symptomatic\"\n\n\nOk now we can trim down to the data we would like and do a few edits. I changed the output of this next code chunk to FALSE, but really all I am doing is trimming down to the columns that I want, removing a single case of NA and making the common names lower case.\n\n#ok sweet so lets just trim our data a little\nd &lt;- d |&gt; \n  select(`HPAI Strain`,`Date Detected`,`Bird Species`,status)\n\n# unique(d$`HPAI Strain`) - This shows a single \"NA\"\n\n#' there are alot of different strains but one is NA let's remove that. \nwhich(is.na(d$`HPAI Strain`))\nd &lt;- d[-674,] #remove by negative indexing\n\n### Let's add our species names to this dataset. \nd &lt;- d |&gt; \n  mutate(sci.name=\"NA\",`Bird Species`=tolower(`Bird Species`))\n\nNow we can actually replace the common names with our species name to make a clean and tidy data set. We are going to do that with a four loop that I built to interface with our species lookup sheet.\n\n#lets change some names with my function from the species lookup\n\nfor(i in 1:nrow(d)){ #loops through the rows\n  host &lt;- d$`Bird Species`[i] #finds the host name \n  host\n  if (host %in% Species_Lookup$alt.common.name){ #checks to see if it's in the data\n    y &lt;- which(Species_Lookup$alt.common.name==host) #gets an index\n    y\n    d$sci.name[i] &lt;- Species_Lookup$scientific.name[y] #replaces it with a species\n    d$sci.name[i]\n  }\n}\n\n#unique(d$sci.name) #look for any NA's\n\n#Check to make sure that all the values go through.\nd |&gt; \n  filter(sci.name==\"NA\")\n\n# A tibble: 0 × 5\n# ℹ 5 variables: HPAI Strain &lt;chr&gt;, Date Detected &lt;chr&gt;, Bird Species &lt;chr&gt;,\n#   status &lt;chr&gt;, sci.name &lt;chr&gt;\n\n\nNice it looks like we did not get any NA’s which can sometimes happen if there is a new mispelling of a common name that needs to be added to the lookup file. Here we seem to be good so we can continue.\nWe should note however that some of these ‘species’ names are note real but rather have something like ‘finch spp’ for example. This is because the common name was not identifiable with a true species. Because we are looking at species level data we need to make sure that we only have true species in our dataset so we can remove them.\n\n#' lets remove them by filtering out the string that have \n#' the pattern \" spp\"\nd |&gt; \n  filter(!str_detect(sci.name,pattern = \" spp\")) -&gt; d.clean\n\n# that was alot of work let's save the progress\n#saveRDS(object = d.clean,file = \"data/d.clean_20240328.rds\")\n\nThe final step in our data wrangling is getting our actual trait data. So far all we have done is rearange some columns and fix some names. Lets get some actual data. To do that we are going to make use of the fact that you can group things by species name and then summarise the results. Lets pivot that data into a format where the rows are species rather than observations.\n\nd.trait &lt;- d.clean %&gt;% #get the data\n  group_by(sci.name, status) %&gt;% #group it \n  summarize(n = n()) %&gt;% #count it!\n  pivot_wider(names_from = status, values_from = n, values_fill = 0) #pivot it\n\nhead(d.trait, n=2) |&gt; kable()\n\n\n\n\nsci.name\nsymptomatic\nalive\n\n\n\n\naccipiter cooperii\n31\n0\n\n\naccipiter striatus\n6\n0\n\n\n\n\n\nNow we can calculate mortality and tolerance from this data!\n\nd.trait &lt;- d.trait |&gt; \n  mutate(total_cases=symptomatic+alive) |&gt; \n  mutate(tolerance=alive/total_cases,\nmortality=symptomatic/total_cases)\n\nhead(d.trait,n=5) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\nsci.name\nsymptomatic\nalive\ntotal_cases\ntolerance\nmortality\n\n\n\n\naccipiter cooperii\n31\n0\n31\n0.0000000\n1.0000000\n\n\naccipiter striatus\n6\n0\n6\n0.0000000\n1.0000000\n\n\naechmophorus occidentalis\n1\n0\n1\n0.0000000\n1.0000000\n\n\nagelaius phoeniceus\n1\n0\n1\n0.0000000\n1.0000000\n\n\naix sponsa\n88\n198\n286\n0.6923077\n0.3076923\n\n\n\n\n\nAmazing we now have a datafram that we can begin to ask some questions about. Let’s shift to thinking about the actual phylogenetic tree because having a multiphylo is not the same as having a single tree (its better but thats besides the point).\n\n\n\nOk in because this is a multiphylo we need to make a single maximum clade credibility tree before we do anything further. We can do that easily with the function mcc() in Phangorn.\n\nset.seed(seed = 700) #just a see that I like. \n\n#' I commented the below out for berevity but \n#' you can follow it along to see \n#' what I did.\n\n# mcc.tree &lt;- mcc(x = sample(allbirdtree,size = 100,replace = F),\n#                 tree = T,\n#                 rooted = T)\n# mcc.tree\n\n#saveRDS(object = mcc.tree,file = \"data/mcc.tree.RDS\")\n\nmcc.tree &lt;- readRDS(file = \"data/mcc.tree.RDS\")\n\nAwesome now we have a single tree - a single VERY large tree - that we can now trim to our taxa of interest. This is where those species names come in hand.\n\n#' nice now we have a tree! Unforunately it is way too many tips so we need to prune it. \nmcc.tree$tip.label &lt;- tolower(mcc.tree$tip.label) #just lowering the names case\n\n#pull out the names I want to keep\nnames &lt;- d.trait$sci.name\nnames &lt;- str_replace(string = names,pattern = \" \",replacement = \"_\")\n\n#pruned.mcc.tree &lt;- keep.tip(phy = mcc.tree,tip=names)\n\n#^ you would get an error if you ran keep.tip()\n\nOh noo we get an error! JK, I knew that was going to happen. There is a few problems with some of the scientific names. In reality this is a problem between eBird and BirdTree but I will let it slide for now. We can work around it and fix it. Let’s just get the names we need to fix and then adjust them.\n\n#lets add a BirdTree/Avonet column \nd.trait &lt;- d.trait |&gt; \n  mutate(avonet.name='NA')\n\n#most of the names in sci.name are good but I there are a few to change. Let's do that and also make them lowercase\nd.trait &lt;- d.trait |&gt; \n  group_by(sci.name) |&gt; \n  mutate(avonet.name=str_replace(string = sci.name,pattern = ' ',replacement = '_'))\n\n#' let's see which of my names actually need to change. \nchk.d.trait &lt;- name.check(phy = mcc.tree,data = d.trait,data.names = d.trait$avonet.name)\nsummary(chk.d.trait) #  Notice there are 28 taxa in my data that are not in my tree (yet)\n\n9860 taxa are present in the tree but not the data:\n    abeillia_abeillei,\n    abroscopus_albogularis,\n    abroscopus_schisticeps,\n    abroscopus_superciliaris,\n    aburria_aburri,\n    acanthagenys_rufogularis,\n    ....\n28 taxa are present in the data but not the tree:\n    anser_caerulescens,\n    anser_rossii,\n    antigone_canadensis,\n    ardea_alba,\n    ardenna_tenuirostris,\n    bubo_scandiacus,\n    ....\n\nTo see complete list of mis-matched taxa, print object.\n\n#lets pull out those names to look at, \nnames.to.check &lt;- chk.d.trait$data_not_tree\n#let's also get an indiex for those names to make them NA's \nindex &lt;- which(d.trait$avonet.name%in%names.to.check)\n\n#lets replace these names to fix with NA's\nd.trait$avonet.name[index] &lt;- \"NA\"\n\nOk so we have these names to fix, how are we actually going to fix them. Well I have run into this before on a prior project so I have this other dataset that I am going to load in just so I can steal the “BirdTree/Avonet” names from it.\n\nbv_data &lt;- read.csv(file = \"/Users/jonathandain/My_Files/My_UMB_Courses/BIO634_Phylogenetics/Final_Project/Report/BV_cleaned_12APR2023_v2.csv\")\n\nNow we can replace the names with this dataset just like we did above with the species lookup file. By the way the eBird names of these two datasets match, how do I know that? Because I made it that way haha.\n\n# replace the names with the BV.data\ni=1\nfor(i in 1:nrow(d.trait)){\n  host &lt;- d.trait$sci.name[i]\n  host\n  host &lt;- gsub(x = host,pattern = ' ',replacement = '_')\n  if (host %in% bv_data$species){\n    y &lt;- which(bv_data$species==host)\n    y\n    x &lt;- unique(bv_data$Avonet_name[y])\n    x\n    d.trait$avonet.name[i] &lt;- x\n    # data$sci.name[i]\n  }\n}\n\n#lets see if this worked\nd.trait |&gt; \n  filter(avonet.name==\"NA\") |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nsci.name\nsymptomatic\nalive\ntotal_cases\ntolerance\nmortality\navonet.name\n\n\n\n\nantigone canadensis\n13\n0\n13\n0\n1\nNA\n\n\nardenna tenuirostris\n3\n0\n3\n0\n1\nNA\n\n\ncharadrius nivosus\n5\n0\n5\n0\n1\nNA\n\n\nchroicocephalus philadelphia\n2\n0\n2\n0\n1\nNA\n\n\ncircus hudsonius\n3\n0\n3\n0\n1\nNA\n\n\nhydroprogne caspia\n26\n0\n26\n0\n1\nNA\n\n\nlarus glaucoides thayeri\n1\n0\n1\n0\n1\nNA\n\n\nnannopterum brasilianum\n3\n0\n3\n0\n1\nNA\n\n\nspatula puna\n1\n0\n1\n0\n1\nNA\n\n\nthalasseus maximus\n9\n0\n9\n0\n1\nNA\n\n\nurile penicillatus\n1\n0\n1\n0\n1\nNA\n\n\n\n\n\nOk now it looks like there are just 11 names to fix instead of the 28 that there were before. Thats totally fine we can do that many by hand. We will tackle this by some simple indexing.\n\n#' Ok so just these lat 11 need to be fixed. \n\nwhich(d.trait$sci.name==\"antigone canadensis\")\nd.trait$avonet.name[18] &lt;- \"grus_canadensis\"\n\nwhich(d.trait$sci.name==\"ardenna tenuirostris\")\nd.trait$avonet.name[22] &lt;- \"puffinus_tenuirostris\"\n\nwhich(d.trait$sci.name==\"charadrius nivosus\")\nd.trait$avonet.name[59] &lt;- \"charadrius_alexandrinus\"\n\nwhich(d.trait$sci.name==\"chroicocephalus philadelphia\")\nd.trait$avonet.name[61] &lt;- \"larus_philadelphia\"\n\nwhich(d.trait$sci.name==\"circus hudsonius\")\nd.trait$avonet.name[62] &lt;- \"circus_cyaneus\"\n\nwhich(d.trait$sci.name==\"hydroprogne caspia\")\nd.trait$avonet.name[88] &lt;- \"sterna_caspia\"\n\nwhich(d.trait$sci.name==\"larus glaucoides thayeri\")\nd.trait$avonet.name[95] &lt;- \"larus_thayeri\"\n\nwhich(d.trait$sci.name==\"nannopterum brasilianum\")\nd.trait$avonet.name[113] &lt;- \"phalacrocorax_brasilianus\"\n\nwhich(d.trait$sci.name==\"spatula puna\")\nd.trait$avonet.name[147] &lt;- \"anas_puna\"\n\nwhich(d.trait$sci.name==\"thalasseus maximus\")\nd.trait$avonet.name[154] &lt;- \"sterna_maxima\"\n\nwhich(d.trait$sci.name==\"urile penicillatus\")\nd.trait$avonet.name[160] &lt;- \"phalacrocorax_penicillatus\"\n\nAmazing now we have all the right species names.\nOh I forgot let’s say we wanted to also put in the order and family that these birds come from. We can also do that with our species lookup file. Let’s just do that as well while we are at it. I think it will come in handy later…..\n\nd.trait &lt;- d.trait |&gt; \n  mutate(type=\"NA\",\n         order=\"NA\",\n         family=\"NA\")\n\n#we can use the same four loop function format as above.\nfor(i in 1:nrow(d.trait)){\n  host &lt;- d.trait$sci.name[i]\n  host\n  host &lt;- str_replace(string = host,pattern = \"_\",replacement = \" \")\n  host\n  if (host %in% Species_Lookup$scientific.name){\n    y &lt;- which(Species_Lookup$scientific.name==host)\n    y\n    type &lt;- unique(Species_Lookup$type[y])\n    type\n    d.trait$type[i] &lt;- type\n    fam &lt;-  unique(Species_Lookup$family[y])\n    fam\n    d.trait$family[i] &lt;- fam\n    order &lt;-  unique(Species_Lookup$order[y])\n    order\n    d.trait$order[i] &lt;- order\n    # data$sci.name[i]\n  }\n}\n\n#looks like there was one error with the thayers gull lets fix that!\nwhich(d.trait$avonet.name==\"larus_thayeri\")\nd.trait$order[95] &lt;- 'charadriiformes'\nd.trait$family[95] &lt;- 'laridae (gulls, terns, and skimmers)'\n\n#one more fix sorry. \nwhich(d.trait$family==\"natidae (ducks, geese, and waterfowl)\")\nd.trait$family[32] &lt;- 'anatidae (ducks, geese, and waterfowl)'\n\nAlright few that took a while but now that we have all the names we can actually prune the tree and then get to plotting this yay.\n\nchk.d.trait &lt;- name.check(phy = mcc.tree,\n                          data = d.trait,\n                          data.names = d.trait$avonet.name)\nsummary(chk.d.trait)\n\n9832 taxa are present in the tree but not the data:\n    abeillia_abeillei,\n    abroscopus_albogularis,\n    abroscopus_schisticeps,\n    abroscopus_superciliaris,\n    aburria_aburri,\n    acanthagenys_rufogularis,\n    ....\n\nTo see complete list of mis-matched taxa, print object.\n\n#' ok let's prune the tree finally!\npruned.mcc.tree &lt;- keep.tip(phy = mcc.tree,tip = d.trait$avonet.name)\n\npruned.mcc.tree\n\n\nPhylogenetic tree with 161 tips and 160 internal nodes.\n\nTip labels:\n  dromaius_novaehollandiae, rhea_americana, callipepla_californica, meleagris_gallopavo, bonasa_umbellus, centrocercus_urophasianus, ...\nNode labels:\n  NA, 0.63, 1, 1, 1, 1, ...\n\nRooted; includes branch lengths.\n\n\nLooks like we finally have a tree. The last thing to do is make sure our data and the tree have the same order in terms of rows.\n\n#one final thing let's make sure that it is in the right order\nrow_index &lt;- match(x = pruned.mcc.tree$tip.label,table = d.trait$avonet.name)\nrow_index\nd.trait[row_index,] -&gt; d.trait\n\n#saveRDS(object = d.trait,file = \"data/d.trait.clean_20240328.rds\")\n\n\n\n\nOk so now we can finally plot this thing. First I just want to chat briefly about what we are actually plotting. We are going to be using a function called contMap() from Phytools. What this will be doing is essentially using ancestral state reconstruction across the branches of the tree. We are trying to infer the changes in a continuous trait along the branches of a tree. What this will end up looking like in our case is a color gradient as the value for ‘mortality’ rate changes across the branches of the tree.\nOk with that said - there is alot more to it - lets actually plot this tree.\nIn order to plot this we need to extract our trait of interest into a named vector that we can pass to contMap to make the plot.\n\n\n\n#read in your cleaned data\nd.trait &lt;- readRDS(file = \"data/d.trait.clean_20240328.rds\")\n\n#d.trait |&gt; \n  #mutate(weighted_tol=mortality*total_cases) \n\n#pull the trait\nmortality &lt;- setNames(object =d.trait$mortality,nm = d.trait$avonet.name)\n\n#make the base plot. \nmort_cMap &lt;- contMap(tree = pruned.mcc.tree,x = mortality,plot = T,ftype='off')\n\n\n\n\n\n\n\n\nYay we have….well we have something. It is not a very good visualization but don’t worry we can make it so much better.\nPlotting for this type of a plot is going to be a really fun exercise in how well you know what is going on internally of a phylogenetic tree. Before we get there though lets mess with the colors a little bit to get a sense of which one we like the best.\nTo do this we are going to use the setMap function to change the color scheme. Then I am going to visualize it without the legend to save space.\n\n#' Lets make four different color schemes. \na &lt;- mort_cMap$cols # the original ones from the above plot\nb &lt;- rev(mort_cMap$cols) # the reverse of those colors. \nc &lt;- grey.colors(n = 30,start = 0) # a greyscale version cause I like that. \nd &lt;- hcl.colors(n = 25,palette = 'Sunset')\ne &lt;- hcl.colors(n = 25,palette = 'Geyser')\nf &lt;- rev(hcl.colors(n = 25,palette = 'Plasma'))\n\n\n#now we can plot them\nmap_a &lt;- setMap(x = mort_cMap,colors=a)\nmap_b &lt;- setMap(x = mort_cMap,colors=b)\nmap_c &lt;- setMap(x = mort_cMap,colors=c)\nmap_d &lt;- setMap(x = mort_cMap,colors=d)\nmap_e &lt;- setMap(x = mort_cMap,colors=e)\nmap_f &lt;- setMap(x = mort_cMap,colors=f)\n\n# now lets plot them. \nM &lt;- matrix(c(1,2,3,4,5,6),nrow = 3,ncol = 2,byrow=T)\nlayout(mat = M)\nplot(map_a,ftype='off',legend=F,outline=F)\nplot(map_b,ftype='off',legend=F,outline=F)\nplot(map_c,ftype='off',legend=F,outline=F)\nplot(map_d,ftype='off',legend=F,outline=F)\nplot(map_e,ftype='off',legend=F,outline=F)\nplot(map_f,ftype='off',legend=F,outline=F)\n\n\n\n\n\n\n\n\nOk I like the red one, ‘Geyser’ and the ‘Sunset’ one. Lets make those and see what they look like when we add the rest of the bits and bobs.\nOk so to make these presentable we need to do some really “sneaky” plotting of the phylogeny. Its really not all that sneaky but we are going to make use of the phylogenetic tree ‘under the hood’ as they say. We are going to use the internals of the tree to make something that is publication worth and that will serve as one of the intial figures on my dissertation.\n\n\n\nFirst we need to add yet another row to our data set. Just a row to indicate sample size. We want this because this dataset is so sparse we want to know where we can ‘trust’ our analysis and where we might need to be a little skeptical. Adding this additional layer of information onto our tree also means we will need to do a little more sneaky plotting to add it but I will explain as I go. If you would like more details and so I give credit to the author of this hack you can see this blog post by Dr. Liam Revell the author of Phytools.\n\n#add the colum and make a plotting tibble\nplotting &lt;- d.trait |&gt; \n  mutate(size=ifelse(total_cases&gt;=2,'n&gt;2','n&lt;2'))\n\nplotting &lt;- plotting |&gt; \n  mutate(size=as.factor(size)) #just make it a factor\n\nplotting &lt;- as.data.frame(plotting) \n#we make the tibble a dataframe because that is \n#what phytools likes.\n\nOk lets adjust and make this work.\n\nh&lt;-max(nodeHeights(mort_cMap$tree)) #gets the max height of the tree\n\n\nsample.size&lt;-mort_cMap$tree #makes a new tree to edit. \n\nsample.size$edge.length[\n  which(sample.size$edge[,2]&lt;=Ntip(sample.size))]&lt;-\n  sample.size$edge.length[\n    which(sample.size$edge[,2]&lt;=Ntip(sample.size))]+0.07*h\n# ^ The above code piece just extends the tip length of the tree\n\nlevs1&lt;-levels(as.factor(plotting$size)) #pulls factors\n\nsample.size&lt;-paintSubTree(sample.size,Ntip(sample.size)+1,\"t\")\n# ^ This paints the tree transparent.\n\nrownames(plotting) &lt;- plotting$avonet.name \n# ^ This gets the rownames on the data frame\n\nfor(i in 1:nrow(plotting)){\n  tip&lt;-which(mort_cMap$tree$tip.label==\n               rownames(plotting)[i])\n  tip\n  sample.size&lt;-paintSubTree(sample.size,node=tip,\n                         state=levs1[plotting[i,\"size\"]],\n                         stem=(0.05*h)/sample.size$edge.length[\n                           which(sample.size$edge[,2]==tip)])\n}\n# ^ This paints the tips of my tree with\n# the color of the sample size. \n\ncols1&lt;-setNames(c(\"transparent\",\"black\",\"grey\"),\n                c(\"t\",levs1))\n# ^ This just colors the tips, and body of the tree\n\nOk that all looks rather convoluted and complex but it boils down to we basically added some length to the tips of our tree and then painted those tips based on the discrete character that we wanted to. In our case we make them grey if they have low sample size and black of they have a better sample size.\nOk so not to actually plot this the way we want with the sample size and all the fun colors we need to do one key thing. Plot the tree without plotting it. Yup we need to get the size of the space that the tree takes up with these new longer tips and then plot another tree on top of it.\n\n#plot to get x and y lims of the space. \nplot(mort_cMap,type=\"arc\",ftype=\"i\",arc_height=0.5*1.05,add=TRUE,lwd=3,fsize=0.6,offset=10)\npp&lt;-get(\"last_plot.phylo\",envir=.PlotPhyloEnv)\n# ^ this pulls those limits\ngarbage &lt;- dev.off()\n# ^this removes the plot made. \n\n\n#plot for real\nmort_cMap &lt;- setMap(mort_cMap,colors=c)\n# plot base tree first\n\n# note without labels\npar(lend=3)\nplot(mort_cMap,type=\"arc\",\n     ftype=\"off\",\n     arc_height=0.5*1.05,\n     add=TRUE,\n     lwd=3,\n     fsize=0.6,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     legend=F)\n\n# now plot the labels and sample size. \nplot(sample.size,\n     cols1,\n     type=\"arc\",\n     arc_height=0.5*1.05,\n     ftype=\"i\",\n     lwd=5,\n     fsize=0.6,\n     add=T,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     offset=15)\n\n\n\n\n\n\n\n\nWow that looks so much better but what if we wanted to add some clade labels and a legend for the black and white, oh and a color bar. Well that is easy enough. Let’s grab out clade labels first.\n\n### add some clade labels. \nans_node &lt;- getMRCA(phy = mort_cMap$tree,tip = d.trait[d.trait$order==\"anseriformes\",]$avonet.name)\n#ans_node\n\n#get the node for all charadriiformes\nchar_node &lt;- getMRCA(phy = mort_cMap$tree,tip = d.trait[d.trait$order==\"charadriiformes\",]$avonet.name)\n#char_node\n\nclade_nodes &lt;- tibble(group=c('anseriformes','charadriiformes'),node=c(ans_node,char_node))\n\n\n# arc.cladelabels(tree = pruned.mcc.tree,\"Anseriformes\",node = clade_nodes$node[1],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F,xlim=pp$x.lim,ylim=pp$y.lim)\n# \n# arc.cladelabels(tree = pruned.mcc.tree,\"Charadriiformes\",node = clade_nodes$node[2],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F)\n\nLet’s plot it once again but add in the clade labels and the legends.\n\n#plot for real\nmort_cMap &lt;- setMap(mort_cMap,colors=f)\n# plot base tree first\n\n# note without labels\npar(lend=3,bg=\"white\",mar=c(0.1,0.1,0.1,0.1))\nplot(mort_cMap,type=\"arc\",\n     ftype=\"off\",\n     arc_height=0.5*1.05,\n     add=TRUE,\n     lwd=4,\n     fsize=0.6,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,legend=F,outline=T)\n\n# now plot the labels and sample size. \nplot(sample.size,\n     cols1,\n     type=\"arc\",\n     arc_height=0.5*1.05,\n     ftype=\"i\",\n     lwd=5,\n     fsize=0.6,\n     add=T,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     offset=15)\n\n# add clade labels\narc.cladelabels(tree = pruned.mcc.tree,\"Anseriformes\",node = clade_nodes$node[1],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F,xlim=pp$x.lim,ylim=pp$y.lim)\n\narc.cladelabels(tree = pruned.mcc.tree,\"Charadriiformes\",node = clade_nodes$node[2],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F)\n\n# add legend\nlegend(\"topleft\",levs1,lwd=6,col=cols1[2:3],\n       title=\"Sample Size\")\n\n# add color bar.\nadd.color.bar(leg=118,cols=mort_cMap$cols,title = \"Mortality Rate due to HPAI\",\n              lims = mort_cMap$lims,digits=3,fsize=0.6,x=-80,y=0,prompt = F)\n\n\n\n\n\n\n\n\nWhat if we wanted to know the amount of phylogenetic signal that might be occuring here. We can do that with phylosig() using two different methods; Blomberg’s K and Pagel’s Lambda\n\n# dev.off() -&gt; garbage\nphylosig(tree = mort_cMap$tree,x = mortality,test = T,method = 'K')\n\n\nPhylogenetic signal K : 0.15881 \nP-value (based on 1000 randomizations) : 0.003 \n\nphylosig(tree = mort_cMap$tree,x = mortality,test = T,method = 'K') |&gt; plot()\n\n\n\n\n\n\n\n\n\nphylosig(tree = mort_cMap$tree, x=mortality,test = T,method = \"lambda\")\n\n\nPhylogenetic signal lambda : 0.604644 \nlogL(lambda) : 3.44939 \nLR(lambda=0) : 53.1951 \nP-value (based on LR test) : 3.02009e-13 \n\nphylosig(tree = mort_cMap$tree, x=mortality,test = T,method = \"lambda\") |&gt; plot()\n\n\n\n\n\n\n\n\nThe Blomberg’s K suggests that while the actual value of K is small it is larger than what is expected under a null distribution given a tree of our configuration. We typically see this when you have rapid diversification or the trait is restricted to a single clade in the tree."
  },
  {
    "objectID": "Blog_Posts/2024-04-30/2024-04-30.html#wild-bird-mortality-and-highly-pathogenic-avian-influenza",
    "href": "Blog_Posts/2024-04-30/2024-04-30.html#wild-bird-mortality-and-highly-pathogenic-avian-influenza",
    "title": "Mortality to HPAI and Trees",
    "section": "",
    "text": "A ‘short’ R script by Jonathan Dain.\nGoal: We want to understand the mortality rates in while birds due to HPAI and how it relates to the underlying phylogeny that connects bird species. So let’s dive in.\n\n\n\npacman::p_load(phytools,\n               ggplot2,\n               ggthemes,\n               tidyverse,\n               geiger,\n               knitr,\n               phangorn,\n               rethinking)\n\n\n\n\nOur data comes from multiple sources so I will load each one and give a brief overview of each. To start we need to get our raw data about mortality in wild birds due to HPAI. This data come from the USDA website. It is a collection of observations of HPAI in wild birds. Admittedly this is a very sparse dataset and I know that alot of their observations are oppourtunistic rather than focused searching….but its what we got so lets put it to work.\n\nraw_usda &lt;- read_csv(file = \"data/hpai-wild-birds (1).csv\")\n\nhead(raw_usda) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nState\nCounty\nCollection Date\nDate Detected\nHPAI Strain\nBird Species\nWOAH Classification\nSampling Method\nSubmitting Agency\n\n\n\n\nSouth Carolina\nColleton\n12/30/2021\n01/13/2022\nEA H5N1\nAmerican wigeon\nWild bird\nHunter harvest\nNWDP\n\n\nSouth Carolina\nColleton\n12/30/2021\n01/13/2022\nEA H5N1\nBlue-winged teal\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n12/30/2021\n01/12/2022\nEA H5N1\nNorthern shoveler\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5N1\nAmerican wigeon\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5\nGadwall\nWild bird\nHunter harvest\nNWDP\n\n\nNorth Carolina\nHyde\n01/08/2022\n01/20/2022\nEA H5\nGadwall\nWild bird\nHunter harvest\nNWDP\n\n\n\n\n\nOk the other dataset that we will need is a species lookup file that I have made for replacing common names with species names. It takes as input a common name - often poorly spelled - and replaces it with the correctly spelled latin name. It can also add in some other useful bits which we will look at later.\n\nSpecies_Lookup &lt;- readRDS(file = \"/Users/jonathandain/My_Files/My_Code/Species_Lookup_Sheet/Species_Lookup_20240323.rds\")\n\nhead(Species_Lookup) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\nalt.common.name\ntype\nscientific.name\nenlish.name.ebird\norder\nfamily\n\n\n\n\nafrican crowned crane\nOther\nbalearica regulorum\ngray crowned-crane\ngruiformes\ngruidae (cranes)\n\n\namerican black duck\nDabbling duck\nanas rubripes\namerican black duck\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\namerican blue-winged teal\nDabbling duck\nspatula discors\nblue-winged teal\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\namerican coot\nOther\nfulica americana\namerican coot\ngruiformes\nrallidae (rails, gallinules, and coots)\n\n\namerican crow\nOther\ncorvus brachyrhynchos\namerican crow\npasseriformes\ncorvidae (crows, jays, and magpies)\n\n\namerican green-winged teal\nDabbling duck\nanas crecca\ngreen-winged teal\nanseriformes\nanatidae (ducks, geese, and waterfowl)\n\n\n\n\n\nFinally as you might be wondering we need a bird phylogenetic tree! Thankfully the hard work of actually producing a bird tree has been done for us by the lovely people at BirdTree, we just get to reap the benefits.\n\n# -&gt; allbirdtree &lt;- readRDS(file = \"data/allbirdtree.rds\")\n\n#' note this is a massive multiphylo object so it may take a smidge of time to load.\n#' I had to remove this due to size limits but those interested can email me for more detail. \n\nOk now that our data is loaded we can move onto some data wrangling. Which is the second most fun part of any research question.\n\n\n\nOk first we need to do some data wrangling to make this USDA data usable.let’s first deal with the getting a sense of the data and if these birds are alive or dead when sampled. In other words what is the disease phenotype.\n\n### make a copy of the data\nd &lt;- raw_usda |&gt; \n  mutate_all(.funs = tolower) #make the names lowercase\n\n### look at the sampling methods as levels\nlevels(as.factor(x = d$`Sampling Method`)) |&gt; kable(col.names = 'Sampling Method')\n\n\n\n\nSampling Method\n\n\n\n\nagency harvest\n\n\nhunter harvest\n\n\nlive bird\n\n\nmorbidity/mortality\n\n\n\n\n\nOk here lies one of the key assumptions I am going to make about this dataset. Given that the hunter harvested and agency harvested birds were likely out moving/behaving naturally prior to their “removal” I think it is fair to assume that these birds did not exhibit any symptomatic behavior of HPAI. That is also true for the live birds.\nThis is of course opposed to the birds in the “morbidity/mortality” group which likely did exhibit symptoms of HPAI.\nWe are going to want to label the two harvest and live bird methods as “healthy/alive birds” and then the mortality birds as ‘dead’.\n\n#to do that we need to get some indices. \nhunt &lt;- which(d$`Sampling Method`==\"hunter harvest\")\nlive &lt;- which(d$`Sampling Method`==\"live bird\")\nagent &lt;- which(d$`Sampling Method`==\"agency harvest\")\ndead &lt;- which(d$`Sampling Method`=='morbidity/mortality')\n\n#now we just need a status column\nd &lt;- d |&gt; \n  mutate(status=\"NA\")\n\n#now we can just manually change these to what we want. \nd$status[hunt] &lt;- \"alive\"\nd$status[live] &lt;- \"alive\"\nd$status[agent] &lt;- 'alive'\nd$status[dead] &lt;- \"symptomatic\"\n\n#just double check our work.\nlevels(as.factor(x = d$status)) \n\n[1] \"alive\"       \"symptomatic\"\n\n\nOk now we can trim down to the data we would like and do a few edits. I changed the output of this next code chunk to FALSE, but really all I am doing is trimming down to the columns that I want, removing a single case of NA and making the common names lower case.\n\n#ok sweet so lets just trim our data a little\nd &lt;- d |&gt; \n  select(`HPAI Strain`,`Date Detected`,`Bird Species`,status)\n\n# unique(d$`HPAI Strain`) - This shows a single \"NA\"\n\n#' there are alot of different strains but one is NA let's remove that. \nwhich(is.na(d$`HPAI Strain`))\nd &lt;- d[-674,] #remove by negative indexing\n\n### Let's add our species names to this dataset. \nd &lt;- d |&gt; \n  mutate(sci.name=\"NA\",`Bird Species`=tolower(`Bird Species`))\n\nNow we can actually replace the common names with our species name to make a clean and tidy data set. We are going to do that with a four loop that I built to interface with our species lookup sheet.\n\n#lets change some names with my function from the species lookup\n\nfor(i in 1:nrow(d)){ #loops through the rows\n  host &lt;- d$`Bird Species`[i] #finds the host name \n  host\n  if (host %in% Species_Lookup$alt.common.name){ #checks to see if it's in the data\n    y &lt;- which(Species_Lookup$alt.common.name==host) #gets an index\n    y\n    d$sci.name[i] &lt;- Species_Lookup$scientific.name[y] #replaces it with a species\n    d$sci.name[i]\n  }\n}\n\n#unique(d$sci.name) #look for any NA's\n\n#Check to make sure that all the values go through.\nd |&gt; \n  filter(sci.name==\"NA\")\n\n# A tibble: 0 × 5\n# ℹ 5 variables: HPAI Strain &lt;chr&gt;, Date Detected &lt;chr&gt;, Bird Species &lt;chr&gt;,\n#   status &lt;chr&gt;, sci.name &lt;chr&gt;\n\n\nNice it looks like we did not get any NA’s which can sometimes happen if there is a new mispelling of a common name that needs to be added to the lookup file. Here we seem to be good so we can continue.\nWe should note however that some of these ‘species’ names are note real but rather have something like ‘finch spp’ for example. This is because the common name was not identifiable with a true species. Because we are looking at species level data we need to make sure that we only have true species in our dataset so we can remove them.\n\n#' lets remove them by filtering out the string that have \n#' the pattern \" spp\"\nd |&gt; \n  filter(!str_detect(sci.name,pattern = \" spp\")) -&gt; d.clean\n\n# that was alot of work let's save the progress\n#saveRDS(object = d.clean,file = \"data/d.clean_20240328.rds\")\n\nThe final step in our data wrangling is getting our actual trait data. So far all we have done is rearange some columns and fix some names. Lets get some actual data. To do that we are going to make use of the fact that you can group things by species name and then summarise the results. Lets pivot that data into a format where the rows are species rather than observations.\n\nd.trait &lt;- d.clean %&gt;% #get the data\n  group_by(sci.name, status) %&gt;% #group it \n  summarize(n = n()) %&gt;% #count it!\n  pivot_wider(names_from = status, values_from = n, values_fill = 0) #pivot it\n\nhead(d.trait, n=2) |&gt; kable()\n\n\n\n\nsci.name\nsymptomatic\nalive\n\n\n\n\naccipiter cooperii\n31\n0\n\n\naccipiter striatus\n6\n0\n\n\n\n\n\nNow we can calculate mortality and tolerance from this data!\n\nd.trait &lt;- d.trait |&gt; \n  mutate(total_cases=symptomatic+alive) |&gt; \n  mutate(tolerance=alive/total_cases,\nmortality=symptomatic/total_cases)\n\nhead(d.trait,n=5) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\nsci.name\nsymptomatic\nalive\ntotal_cases\ntolerance\nmortality\n\n\n\n\naccipiter cooperii\n31\n0\n31\n0.0000000\n1.0000000\n\n\naccipiter striatus\n6\n0\n6\n0.0000000\n1.0000000\n\n\naechmophorus occidentalis\n1\n0\n1\n0.0000000\n1.0000000\n\n\nagelaius phoeniceus\n1\n0\n1\n0.0000000\n1.0000000\n\n\naix sponsa\n88\n198\n286\n0.6923077\n0.3076923\n\n\n\n\n\nAmazing we now have a datafram that we can begin to ask some questions about. Let’s shift to thinking about the actual phylogenetic tree because having a multiphylo is not the same as having a single tree (its better but thats besides the point).\n\n\n\nOk in because this is a multiphylo we need to make a single maximum clade credibility tree before we do anything further. We can do that easily with the function mcc() in Phangorn.\n\nset.seed(seed = 700) #just a see that I like. \n\n#' I commented the below out for berevity but \n#' you can follow it along to see \n#' what I did.\n\n# mcc.tree &lt;- mcc(x = sample(allbirdtree,size = 100,replace = F),\n#                 tree = T,\n#                 rooted = T)\n# mcc.tree\n\n#saveRDS(object = mcc.tree,file = \"data/mcc.tree.RDS\")\n\nmcc.tree &lt;- readRDS(file = \"data/mcc.tree.RDS\")\n\nAwesome now we have a single tree - a single VERY large tree - that we can now trim to our taxa of interest. This is where those species names come in hand.\n\n#' nice now we have a tree! Unforunately it is way too many tips so we need to prune it. \nmcc.tree$tip.label &lt;- tolower(mcc.tree$tip.label) #just lowering the names case\n\n#pull out the names I want to keep\nnames &lt;- d.trait$sci.name\nnames &lt;- str_replace(string = names,pattern = \" \",replacement = \"_\")\n\n#pruned.mcc.tree &lt;- keep.tip(phy = mcc.tree,tip=names)\n\n#^ you would get an error if you ran keep.tip()\n\nOh noo we get an error! JK, I knew that was going to happen. There is a few problems with some of the scientific names. In reality this is a problem between eBird and BirdTree but I will let it slide for now. We can work around it and fix it. Let’s just get the names we need to fix and then adjust them.\n\n#lets add a BirdTree/Avonet column \nd.trait &lt;- d.trait |&gt; \n  mutate(avonet.name='NA')\n\n#most of the names in sci.name are good but I there are a few to change. Let's do that and also make them lowercase\nd.trait &lt;- d.trait |&gt; \n  group_by(sci.name) |&gt; \n  mutate(avonet.name=str_replace(string = sci.name,pattern = ' ',replacement = '_'))\n\n#' let's see which of my names actually need to change. \nchk.d.trait &lt;- name.check(phy = mcc.tree,data = d.trait,data.names = d.trait$avonet.name)\nsummary(chk.d.trait) #  Notice there are 28 taxa in my data that are not in my tree (yet)\n\n9860 taxa are present in the tree but not the data:\n    abeillia_abeillei,\n    abroscopus_albogularis,\n    abroscopus_schisticeps,\n    abroscopus_superciliaris,\n    aburria_aburri,\n    acanthagenys_rufogularis,\n    ....\n28 taxa are present in the data but not the tree:\n    anser_caerulescens,\n    anser_rossii,\n    antigone_canadensis,\n    ardea_alba,\n    ardenna_tenuirostris,\n    bubo_scandiacus,\n    ....\n\nTo see complete list of mis-matched taxa, print object.\n\n#lets pull out those names to look at, \nnames.to.check &lt;- chk.d.trait$data_not_tree\n#let's also get an indiex for those names to make them NA's \nindex &lt;- which(d.trait$avonet.name%in%names.to.check)\n\n#lets replace these names to fix with NA's\nd.trait$avonet.name[index] &lt;- \"NA\"\n\nOk so we have these names to fix, how are we actually going to fix them. Well I have run into this before on a prior project so I have this other dataset that I am going to load in just so I can steal the “BirdTree/Avonet” names from it.\n\nbv_data &lt;- read.csv(file = \"/Users/jonathandain/My_Files/My_UMB_Courses/BIO634_Phylogenetics/Final_Project/Report/BV_cleaned_12APR2023_v2.csv\")\n\nNow we can replace the names with this dataset just like we did above with the species lookup file. By the way the eBird names of these two datasets match, how do I know that? Because I made it that way haha.\n\n# replace the names with the BV.data\ni=1\nfor(i in 1:nrow(d.trait)){\n  host &lt;- d.trait$sci.name[i]\n  host\n  host &lt;- gsub(x = host,pattern = ' ',replacement = '_')\n  if (host %in% bv_data$species){\n    y &lt;- which(bv_data$species==host)\n    y\n    x &lt;- unique(bv_data$Avonet_name[y])\n    x\n    d.trait$avonet.name[i] &lt;- x\n    # data$sci.name[i]\n  }\n}\n\n#lets see if this worked\nd.trait |&gt; \n  filter(avonet.name==\"NA\") |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nsci.name\nsymptomatic\nalive\ntotal_cases\ntolerance\nmortality\navonet.name\n\n\n\n\nantigone canadensis\n13\n0\n13\n0\n1\nNA\n\n\nardenna tenuirostris\n3\n0\n3\n0\n1\nNA\n\n\ncharadrius nivosus\n5\n0\n5\n0\n1\nNA\n\n\nchroicocephalus philadelphia\n2\n0\n2\n0\n1\nNA\n\n\ncircus hudsonius\n3\n0\n3\n0\n1\nNA\n\n\nhydroprogne caspia\n26\n0\n26\n0\n1\nNA\n\n\nlarus glaucoides thayeri\n1\n0\n1\n0\n1\nNA\n\n\nnannopterum brasilianum\n3\n0\n3\n0\n1\nNA\n\n\nspatula puna\n1\n0\n1\n0\n1\nNA\n\n\nthalasseus maximus\n9\n0\n9\n0\n1\nNA\n\n\nurile penicillatus\n1\n0\n1\n0\n1\nNA\n\n\n\n\n\nOk now it looks like there are just 11 names to fix instead of the 28 that there were before. Thats totally fine we can do that many by hand. We will tackle this by some simple indexing.\n\n#' Ok so just these lat 11 need to be fixed. \n\nwhich(d.trait$sci.name==\"antigone canadensis\")\nd.trait$avonet.name[18] &lt;- \"grus_canadensis\"\n\nwhich(d.trait$sci.name==\"ardenna tenuirostris\")\nd.trait$avonet.name[22] &lt;- \"puffinus_tenuirostris\"\n\nwhich(d.trait$sci.name==\"charadrius nivosus\")\nd.trait$avonet.name[59] &lt;- \"charadrius_alexandrinus\"\n\nwhich(d.trait$sci.name==\"chroicocephalus philadelphia\")\nd.trait$avonet.name[61] &lt;- \"larus_philadelphia\"\n\nwhich(d.trait$sci.name==\"circus hudsonius\")\nd.trait$avonet.name[62] &lt;- \"circus_cyaneus\"\n\nwhich(d.trait$sci.name==\"hydroprogne caspia\")\nd.trait$avonet.name[88] &lt;- \"sterna_caspia\"\n\nwhich(d.trait$sci.name==\"larus glaucoides thayeri\")\nd.trait$avonet.name[95] &lt;- \"larus_thayeri\"\n\nwhich(d.trait$sci.name==\"nannopterum brasilianum\")\nd.trait$avonet.name[113] &lt;- \"phalacrocorax_brasilianus\"\n\nwhich(d.trait$sci.name==\"spatula puna\")\nd.trait$avonet.name[147] &lt;- \"anas_puna\"\n\nwhich(d.trait$sci.name==\"thalasseus maximus\")\nd.trait$avonet.name[154] &lt;- \"sterna_maxima\"\n\nwhich(d.trait$sci.name==\"urile penicillatus\")\nd.trait$avonet.name[160] &lt;- \"phalacrocorax_penicillatus\"\n\nAmazing now we have all the right species names.\nOh I forgot let’s say we wanted to also put in the order and family that these birds come from. We can also do that with our species lookup file. Let’s just do that as well while we are at it. I think it will come in handy later…..\n\nd.trait &lt;- d.trait |&gt; \n  mutate(type=\"NA\",\n         order=\"NA\",\n         family=\"NA\")\n\n#we can use the same four loop function format as above.\nfor(i in 1:nrow(d.trait)){\n  host &lt;- d.trait$sci.name[i]\n  host\n  host &lt;- str_replace(string = host,pattern = \"_\",replacement = \" \")\n  host\n  if (host %in% Species_Lookup$scientific.name){\n    y &lt;- which(Species_Lookup$scientific.name==host)\n    y\n    type &lt;- unique(Species_Lookup$type[y])\n    type\n    d.trait$type[i] &lt;- type\n    fam &lt;-  unique(Species_Lookup$family[y])\n    fam\n    d.trait$family[i] &lt;- fam\n    order &lt;-  unique(Species_Lookup$order[y])\n    order\n    d.trait$order[i] &lt;- order\n    # data$sci.name[i]\n  }\n}\n\n#looks like there was one error with the thayers gull lets fix that!\nwhich(d.trait$avonet.name==\"larus_thayeri\")\nd.trait$order[95] &lt;- 'charadriiformes'\nd.trait$family[95] &lt;- 'laridae (gulls, terns, and skimmers)'\n\n#one more fix sorry. \nwhich(d.trait$family==\"natidae (ducks, geese, and waterfowl)\")\nd.trait$family[32] &lt;- 'anatidae (ducks, geese, and waterfowl)'\n\nAlright few that took a while but now that we have all the names we can actually prune the tree and then get to plotting this yay.\n\nchk.d.trait &lt;- name.check(phy = mcc.tree,\n                          data = d.trait,\n                          data.names = d.trait$avonet.name)\nsummary(chk.d.trait)\n\n9832 taxa are present in the tree but not the data:\n    abeillia_abeillei,\n    abroscopus_albogularis,\n    abroscopus_schisticeps,\n    abroscopus_superciliaris,\n    aburria_aburri,\n    acanthagenys_rufogularis,\n    ....\n\nTo see complete list of mis-matched taxa, print object.\n\n#' ok let's prune the tree finally!\npruned.mcc.tree &lt;- keep.tip(phy = mcc.tree,tip = d.trait$avonet.name)\n\npruned.mcc.tree\n\n\nPhylogenetic tree with 161 tips and 160 internal nodes.\n\nTip labels:\n  dromaius_novaehollandiae, rhea_americana, callipepla_californica, meleagris_gallopavo, bonasa_umbellus, centrocercus_urophasianus, ...\nNode labels:\n  NA, 0.63, 1, 1, 1, 1, ...\n\nRooted; includes branch lengths.\n\n\nLooks like we finally have a tree. The last thing to do is make sure our data and the tree have the same order in terms of rows.\n\n#one final thing let's make sure that it is in the right order\nrow_index &lt;- match(x = pruned.mcc.tree$tip.label,table = d.trait$avonet.name)\nrow_index\nd.trait[row_index,] -&gt; d.trait\n\n#saveRDS(object = d.trait,file = \"data/d.trait.clean_20240328.rds\")\n\n\n\n\nOk so now we can finally plot this thing. First I just want to chat briefly about what we are actually plotting. We are going to be using a function called contMap() from Phytools. What this will be doing is essentially using ancestral state reconstruction across the branches of the tree. We are trying to infer the changes in a continuous trait along the branches of a tree. What this will end up looking like in our case is a color gradient as the value for ‘mortality’ rate changes across the branches of the tree.\nOk with that said - there is alot more to it - lets actually plot this tree.\nIn order to plot this we need to extract our trait of interest into a named vector that we can pass to contMap to make the plot.\n\n\n\n#read in your cleaned data\nd.trait &lt;- readRDS(file = \"data/d.trait.clean_20240328.rds\")\n\n#d.trait |&gt; \n  #mutate(weighted_tol=mortality*total_cases) \n\n#pull the trait\nmortality &lt;- setNames(object =d.trait$mortality,nm = d.trait$avonet.name)\n\n#make the base plot. \nmort_cMap &lt;- contMap(tree = pruned.mcc.tree,x = mortality,plot = T,ftype='off')\n\n\n\n\n\n\n\n\nYay we have….well we have something. It is not a very good visualization but don’t worry we can make it so much better.\nPlotting for this type of a plot is going to be a really fun exercise in how well you know what is going on internally of a phylogenetic tree. Before we get there though lets mess with the colors a little bit to get a sense of which one we like the best.\nTo do this we are going to use the setMap function to change the color scheme. Then I am going to visualize it without the legend to save space.\n\n#' Lets make four different color schemes. \na &lt;- mort_cMap$cols # the original ones from the above plot\nb &lt;- rev(mort_cMap$cols) # the reverse of those colors. \nc &lt;- grey.colors(n = 30,start = 0) # a greyscale version cause I like that. \nd &lt;- hcl.colors(n = 25,palette = 'Sunset')\ne &lt;- hcl.colors(n = 25,palette = 'Geyser')\nf &lt;- rev(hcl.colors(n = 25,palette = 'Plasma'))\n\n\n#now we can plot them\nmap_a &lt;- setMap(x = mort_cMap,colors=a)\nmap_b &lt;- setMap(x = mort_cMap,colors=b)\nmap_c &lt;- setMap(x = mort_cMap,colors=c)\nmap_d &lt;- setMap(x = mort_cMap,colors=d)\nmap_e &lt;- setMap(x = mort_cMap,colors=e)\nmap_f &lt;- setMap(x = mort_cMap,colors=f)\n\n# now lets plot them. \nM &lt;- matrix(c(1,2,3,4,5,6),nrow = 3,ncol = 2,byrow=T)\nlayout(mat = M)\nplot(map_a,ftype='off',legend=F,outline=F)\nplot(map_b,ftype='off',legend=F,outline=F)\nplot(map_c,ftype='off',legend=F,outline=F)\nplot(map_d,ftype='off',legend=F,outline=F)\nplot(map_e,ftype='off',legend=F,outline=F)\nplot(map_f,ftype='off',legend=F,outline=F)\n\n\n\n\n\n\n\n\nOk I like the red one, ‘Geyser’ and the ‘Sunset’ one. Lets make those and see what they look like when we add the rest of the bits and bobs.\nOk so to make these presentable we need to do some really “sneaky” plotting of the phylogeny. Its really not all that sneaky but we are going to make use of the phylogenetic tree ‘under the hood’ as they say. We are going to use the internals of the tree to make something that is publication worth and that will serve as one of the intial figures on my dissertation.\n\n\n\nFirst we need to add yet another row to our data set. Just a row to indicate sample size. We want this because this dataset is so sparse we want to know where we can ‘trust’ our analysis and where we might need to be a little skeptical. Adding this additional layer of information onto our tree also means we will need to do a little more sneaky plotting to add it but I will explain as I go. If you would like more details and so I give credit to the author of this hack you can see this blog post by Dr. Liam Revell the author of Phytools.\n\n#add the colum and make a plotting tibble\nplotting &lt;- d.trait |&gt; \n  mutate(size=ifelse(total_cases&gt;=2,'n&gt;2','n&lt;2'))\n\nplotting &lt;- plotting |&gt; \n  mutate(size=as.factor(size)) #just make it a factor\n\nplotting &lt;- as.data.frame(plotting) \n#we make the tibble a dataframe because that is \n#what phytools likes.\n\nOk lets adjust and make this work.\n\nh&lt;-max(nodeHeights(mort_cMap$tree)) #gets the max height of the tree\n\n\nsample.size&lt;-mort_cMap$tree #makes a new tree to edit. \n\nsample.size$edge.length[\n  which(sample.size$edge[,2]&lt;=Ntip(sample.size))]&lt;-\n  sample.size$edge.length[\n    which(sample.size$edge[,2]&lt;=Ntip(sample.size))]+0.07*h\n# ^ The above code piece just extends the tip length of the tree\n\nlevs1&lt;-levels(as.factor(plotting$size)) #pulls factors\n\nsample.size&lt;-paintSubTree(sample.size,Ntip(sample.size)+1,\"t\")\n# ^ This paints the tree transparent.\n\nrownames(plotting) &lt;- plotting$avonet.name \n# ^ This gets the rownames on the data frame\n\nfor(i in 1:nrow(plotting)){\n  tip&lt;-which(mort_cMap$tree$tip.label==\n               rownames(plotting)[i])\n  tip\n  sample.size&lt;-paintSubTree(sample.size,node=tip,\n                         state=levs1[plotting[i,\"size\"]],\n                         stem=(0.05*h)/sample.size$edge.length[\n                           which(sample.size$edge[,2]==tip)])\n}\n# ^ This paints the tips of my tree with\n# the color of the sample size. \n\ncols1&lt;-setNames(c(\"transparent\",\"black\",\"grey\"),\n                c(\"t\",levs1))\n# ^ This just colors the tips, and body of the tree\n\nOk that all looks rather convoluted and complex but it boils down to we basically added some length to the tips of our tree and then painted those tips based on the discrete character that we wanted to. In our case we make them grey if they have low sample size and black of they have a better sample size.\nOk so not to actually plot this the way we want with the sample size and all the fun colors we need to do one key thing. Plot the tree without plotting it. Yup we need to get the size of the space that the tree takes up with these new longer tips and then plot another tree on top of it.\n\n#plot to get x and y lims of the space. \nplot(mort_cMap,type=\"arc\",ftype=\"i\",arc_height=0.5*1.05,add=TRUE,lwd=3,fsize=0.6,offset=10)\npp&lt;-get(\"last_plot.phylo\",envir=.PlotPhyloEnv)\n# ^ this pulls those limits\ngarbage &lt;- dev.off()\n# ^this removes the plot made. \n\n\n#plot for real\nmort_cMap &lt;- setMap(mort_cMap,colors=c)\n# plot base tree first\n\n# note without labels\npar(lend=3)\nplot(mort_cMap,type=\"arc\",\n     ftype=\"off\",\n     arc_height=0.5*1.05,\n     add=TRUE,\n     lwd=3,\n     fsize=0.6,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     legend=F)\n\n# now plot the labels and sample size. \nplot(sample.size,\n     cols1,\n     type=\"arc\",\n     arc_height=0.5*1.05,\n     ftype=\"i\",\n     lwd=5,\n     fsize=0.6,\n     add=T,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     offset=15)\n\n\n\n\n\n\n\n\nWow that looks so much better but what if we wanted to add some clade labels and a legend for the black and white, oh and a color bar. Well that is easy enough. Let’s grab out clade labels first.\n\n### add some clade labels. \nans_node &lt;- getMRCA(phy = mort_cMap$tree,tip = d.trait[d.trait$order==\"anseriformes\",]$avonet.name)\n#ans_node\n\n#get the node for all charadriiformes\nchar_node &lt;- getMRCA(phy = mort_cMap$tree,tip = d.trait[d.trait$order==\"charadriiformes\",]$avonet.name)\n#char_node\n\nclade_nodes &lt;- tibble(group=c('anseriformes','charadriiformes'),node=c(ans_node,char_node))\n\n\n# arc.cladelabels(tree = pruned.mcc.tree,\"Anseriformes\",node = clade_nodes$node[1],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F,xlim=pp$x.lim,ylim=pp$y.lim)\n# \n# arc.cladelabels(tree = pruned.mcc.tree,\"Charadriiformes\",node = clade_nodes$node[2],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F)\n\nLet’s plot it once again but add in the clade labels and the legends.\n\n#plot for real\nmort_cMap &lt;- setMap(mort_cMap,colors=f)\n# plot base tree first\n\n# note without labels\npar(lend=3,bg=\"white\",mar=c(0.1,0.1,0.1,0.1))\nplot(mort_cMap,type=\"arc\",\n     ftype=\"off\",\n     arc_height=0.5*1.05,\n     add=TRUE,\n     lwd=4,\n     fsize=0.6,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,legend=F,outline=T)\n\n# now plot the labels and sample size. \nplot(sample.size,\n     cols1,\n     type=\"arc\",\n     arc_height=0.5*1.05,\n     ftype=\"i\",\n     lwd=5,\n     fsize=0.6,\n     add=T,\n     xlim=pp$x.lim,\n     ylim=pp$y.lim,\n     offset=15)\n\n# add clade labels\narc.cladelabels(tree = pruned.mcc.tree,\"Anseriformes\",node = clade_nodes$node[1],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F,xlim=pp$x.lim,ylim=pp$y.lim)\n\narc.cladelabels(tree = pruned.mcc.tree,\"Charadriiformes\",node = clade_nodes$node[2],col=\"black\",lab.offset=1.07,ln.offset=1.04,mark.node=F)\n\n# add legend\nlegend(\"topleft\",levs1,lwd=6,col=cols1[2:3],\n       title=\"Sample Size\")\n\n# add color bar.\nadd.color.bar(leg=118,cols=mort_cMap$cols,title = \"Mortality Rate due to HPAI\",\n              lims = mort_cMap$lims,digits=3,fsize=0.6,x=-80,y=0,prompt = F)\n\n\n\n\n\n\n\n\nWhat if we wanted to know the amount of phylogenetic signal that might be occuring here. We can do that with phylosig() using two different methods; Blomberg’s K and Pagel’s Lambda\n\n# dev.off() -&gt; garbage\nphylosig(tree = mort_cMap$tree,x = mortality,test = T,method = 'K')\n\n\nPhylogenetic signal K : 0.15881 \nP-value (based on 1000 randomizations) : 0.003 \n\nphylosig(tree = mort_cMap$tree,x = mortality,test = T,method = 'K') |&gt; plot()\n\n\n\n\n\n\n\n\n\nphylosig(tree = mort_cMap$tree, x=mortality,test = T,method = \"lambda\")\n\n\nPhylogenetic signal lambda : 0.604644 \nlogL(lambda) : 3.44939 \nLR(lambda=0) : 53.1951 \nP-value (based on LR test) : 3.02009e-13 \n\nphylosig(tree = mort_cMap$tree, x=mortality,test = T,method = \"lambda\") |&gt; plot()\n\n\n\n\n\n\n\n\nThe Blomberg’s K suggests that while the actual value of K is small it is larger than what is expected under a null distribution given a tree of our configuration. We typically see this when you have rapid diversification or the trait is restricted to a single clade in the tree."
  },
  {
    "objectID": "Blog_Posts/2024-04-30/2024-04-30.html#our-final-plot",
    "href": "Blog_Posts/2024-04-30/2024-04-30.html#our-final-plot",
    "title": "Mortality to HPAI and Trees",
    "section": "Our Final Plot:",
    "text": "Our Final Plot:\nFinally lets just plot the final tree one last time to really see it.\n\n\n\nMortality to HPAI Plotted on an Avian Tree\n\n\n\nKey Takeaways:\n\nThe majority of the tree is purple, indicating very high mortality due to HPAI.\n\nThe areas of yellow, indicating low mortality to HPAI are primarily restricted to members of the family ANATIDAE, which include our lovely friends the Mallard and American Black Duck.\n\nWhile the “tolerance” to HPAI is likely to place a species into the “super-spreader” camp given that there are so many taxa that have high mortality there might be other “super-spreaders” that exhibit a vastly different phenotype than being asymptomatic.\n\n\n\nFuture Directions:\n\nTo answer that last point about alternatives to asymptomatic “super-spreaders”, I am planning on performing a bayesian phylodynamic assay to evaluate source/sink dynamics. This will tell me if the taxa that are colored purple are acting as sources “spreaders” or sinks. In short it will tell me if there really is another version of “super-spreader”.\nAdditionally, it is important to keep in mind that this analysis is very hypothesis generating but needs to be paired with a more stringent study. As a professor noted with me during a meeting, we do not have the denominator of the testing quota the USDA needs each year. Without this we can’t get a true measure of prevalence, which means we can’t remove the probable duck bias that is likely here.\n\nI hope that this script has been as helpful to you as it was to me. As always keep your eyes to the sky!\nCheers, Jonathan Dain\n\n\n\nMortality to HPAI Plotted on an Avian Tree"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Yours truly on Appledore Island, where Great Black-Back Gulls and Herring Gulls breed in massive numbers\n\n\nHello there my dear friends and welcome to the world of birds and their viruses\n\nInside the Lab:\nMy name is Jonathan Dain, and I am a Ph.D. student at UMASS Boston working in the VirusPlusLab led by Dr. Nichola Hill. We are a “Disease Ecology” lab focused on answering questions about the recent avian influenza outbreaks in wild birds. My personal interests lie at the intersection of the host virus dynamic. What are the ecological and phylogenetic drivers of avian influenza in the current North American outbreak? What can we learn from the host about infection with this virus in terms of the disease phenotype and immune response? What can we learn from the viral genomes about spread of the virus, host factors affecting spread and much more? Why do some bird species get infected with the virus and die very quickly while others are asymptomatic? How much does the host gene expression impact the spread of this virus into new areas and populations?\n\n\nOutside the Lab:\nApart from my studies at UMB, I am a fun-loving husband to Amanda Dain. I am an avid herpetologist and ornithologist and you will often find me with eyes to the sky, flipping logs, or waist-deep in a bog with frogs. As a lover of coffee, I am always down to pour a cup and sit at the table with a great book or have a deep conversation with a friend. I do my best to find beauty in the little moments in life and I have often said “wonder makes the common uncommon”. So come join me on this adventure with birds, viruses, coffee, and books and let’s see what wonders are ahead of us."
  },
  {
    "objectID": "Blog_Posts/2024-05-26/2024-05-26.html",
    "href": "Blog_Posts/2024-05-26/2024-05-26.html",
    "title": "Hark! The Gulls of Appledore!",
    "section": "",
    "text": "Welcome to Appledore!\n\n\n\nBraving the Wall of Sound\nIt was another hot, muggy day. We had been traversing the island all day heavy laden with cotton swabs, various sample vials, banding equipment, rebar cubes with wire fence siding, helmets oh, and of course gull sticks. Our target of course is the reason we needed such “sticks”, which were nothing more than pieces of lobster traps with a plastic bottle duck tapped to the end of it. (See Figure 1 below). We were after the Great Black Backed Gull, the largest gull species in the world and which happily breeds in good numbers on this beautiful island.\n\n\n\nFigure 1: My Gull Stick\n\n\nTo be here you need to be willing to brave a cacophony of noise, flying fecal matter, the not so occasional swooping and of course, the many bites that ensue once a gull is in hand. Who might be on such a crew? To start we have a group of banders who have been coming to this island for the last 16 years. Then we have a researcher from LMU who is studying the isotopic signature of chick hatch order in these birds. Finally, you have the VirusPlusLab (Melba TorresSosa and myself) who love all things gull and virus.\nThe Gull (Goal) is simple we need to place metal bands with a federal ID number on the bird, place an alphanumeric band, get feathers for isotopes, get a blood sample for genetic sexing, a blood sample for examining the immune profile, a blood sample to check antibody status, body measurements, and of course oral/cloacal swabs for potential virus! Sounds easy enough right?\nWell needless to say these were some hot, stinky, noisy yet incredible, magical, wonderful days. We sampled 34 adult GBBGs (the American Birding Association four-letter code for Great Black Back Gulls), taking swabs, feathers, and blood samples from all of them. Some of us scored some new physical mementos of the birds - see below - and all of us got swooped. Once I am back on the mainland I will be running these samples through a quantitative PCR protocol to identify if any of the swabs are positive for highly pathogenic avian influenza. For now, I can just enjoy the view and share some of the highlights with you, my dear readers.\n\n\n\nFigure 2: Bite Marks from a GBBG\n\n\n\n\nA stolen Notebook\nThe sunset pavilion was supposed to be an idyllic spot to watch the sun dip below the ocean waves in peace. While I still think this spot on the Island is very idyllic, peace is maybe not the most apt word to use here. Several pairs of GBBGs have claimed this area as their “personal” nursery, enlisting the help of other gulls to watch the area and keep chicks contained. The result, any human within a 10-foot radius of the pavilion is subject to poop, squawks and much swooping. This was our first stop on the island to check for nesting gulls and our colleague Dylan - an extraordinary gull researcher - was using their field notebook as an improvised gull stick. As they were about to reach the relative safety of the roof a gull swooped down and snatched the notebook out of their hand before flying away and dropping it upon the head of another nesting gull! If a gull could speak English the squawk we heard would have been some colorful language indeed.\n\n\nFecal Explosions\nAs you may recall in a previous blog post, I take cloacal samples to “hunt” for the virus. Usually, this is a very clean and efficient procedure that takes only a few seconds. Well, this particular swab went a little differently than usual. As I was removing the swab to place it in a vial the bird decided now would be a great time to relieve themselves. This is normally totally fine as we love to get a fecal sample from birds when we can. However when the fecal matter comes with pressure and squirts up your arm, and inside your gloves……then it becomes a problem. We all had quite a moment of surprise before giving way to laughter as I cleaned myself off and then later changed my shirt before dinner.\n\n\nThe Most Valuable Player\nRNA is fragile. Avian influenza is a RNA virus so if you want to sequence it you need to make sure it is protected. One way to do that is by keeping your samples cold, like very cold (-150 degrees Celsius) for example. But Jonathan you are on a Island already described as hot, how in the world are you going to do that? Enter stage left Joyce, the liquid nitrogen container! Joyce is the hardest working personnel at the VirusPlusLab, easily making her the most valuable player in a virus hunting expedition. An added bonus is that when you open her to place samples inside she billows out nitrogen and looks like an amazing science experiment. Each time we opened her up to drop off the latest bach of samples we would hear a collective gasp. Joyce’s legend has taken the island by storm and now people from the boat crew to the island coordinator all know the name Joyce and just who “she” is. See a figure below for her in all of her splendor as well as a post by Sarah - a member of the gull bander team - for a sunset picture of Joyce.\n\n\nA Grateful Heart\nThroughout this trip we were shadowed by a reported named Dean Russell who works for the Endless Thread Podcast, among others. Dean’s goal was to capture interesting stories about the gulls, this island, and the research going on here. One of the things that he asked me was “What do you like about the gulls?”.\nAn innocent question but one that sets my mind racing. Gulls can sometimes carry the negative connotation of “sea rats”. I believe that this is in part because of how similar they are to humans. When I watch these birds I see a myriad of social interactions happening spread across a kaleidoscope of individual personalities. Whether these birds are shy or bold, loud or quiet, tightly clustered or not all changes the social dynamics they display. Each gull is unique and each interaction with them even more so. People who have been on Appledore for many years will attest to the fact that these gulls remember people on the island. Our own banding team spoke to the idea that when these gull see our helmets and “sticks” they know what we are there to do. Great Black Back Gulls are intelligent, beautifully social, and they of course are fierce protectors and parents. I have been tapped, bit, and charged at by many parents while I have sampled their offspring. They will do all they can to keep us and our swabs away from their babies.\n\n\n\nFigure 3: An Angry Momma GBBG\n\n\nI love these birds because I can see pieces of myself in them. In studying them I learn things about myself, they are like a mirror in so many ways. Plus they have an audacity that is unmatched.\nWell that was many thoughts and I hope you enjoyed reading them. Take a look below if you want to see more cute gull photos. Until next time keep your eyes to the sky.\nCheers,\nJonathan Dain\n\n\n\n\n\n\n\n\n\nFigure 3: A Cliffside Beauty\n\n\n\n\n\n\n\nFigure 4: A Sunset Gull Combo\n\n\n\n\n\n\n\n\n\nFigure 5: A Wet Gull After A Morning Drizzle\n\n\n\n\n\n\n\n\nWelcome to Appledore!\nFigure 1: My Gull Stick\nFigure 2: Bite Marks from a GBBG\nFigure 3: An Angry Momma GBBG\nFigure 3: A Cliffside Beauty\nFigure 4: A Sunset Gull Combo\nFigure 5: A Wet Gull After A Morning Drizzle"
  },
  {
    "objectID": "Photos.html",
    "href": "Photos.html",
    "title": "Photo Gallery",
    "section": "",
    "text": "Hello there and Welcome!\nHere you will find a collection of photos detailing all of the cool places that my PhD research has taken me. You will also meet some of the amazing people who have been by my side through it all. I hope that you enjoy and share some of the same wonder we had when seeing these birds.\n\nNantucket Island:\n\n\n\n\n\n\n\n\n\nUMB’s Field Station on Nantucket\n\n\n\n\n\n\n\nThe Main window in the field station\n\n\n\n\n\n\n\nA marsh view\n\n\n\n\n\n\n\n\n\nThe “Scallop Pile”. The gulls love this tasty snack and we always find virus here.\n\n\n\n\n\n\n\nSometimes you get “painted” while sampling.\n\n\n\n\n\n\n\nWe sample here throughout the annual cycle, i.e. even when it is below freezing. Kate, Nichola, Melba and I from left to right.\n\n\n\n\n\n\n\n\n\nWhile we primarialy sample ducks and gulls, occasionally we get some others like this male Common Eider held by Melba.\n\n\n\n\n\n\n\nWhat a beauty\n\n\n\n\n\n\n\nThere is a locally famous group of domestic ducks that love to get free corn in exchange for samples. Here Melba holds this handsome fella.\n\n\n\n\n\n\n\nAppledore Island:\nComing Soon….. ::: {layout-ncol=“3”}\n:::\n\n\nUMass Boston:\nComing Soon….\n\n\nTools of the Trade:\nComing Soon….\n\n\n\nUMB’s Field Station on Nantucket\nThe Main window in the field station\nA marsh view\nThe “Scallop Pile”. The gulls love this tasty snack and we always find virus here.\nSometimes you get “painted” while sampling.\nWe sample here throughout the annual cycle, i.e. even when it is below freezing. Kate, Nichola, Melba and I from left to right.\nWhile we primarialy sample ducks and gulls, occasionally we get some others like this male Common Eider held by Melba.\nWhat a beauty\nThere is a locally famous group of domestic ducks that love to get free corn in exchange for samples. Here Melba holds this handsome fella."
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html",
    "title": "Phylogenetic Resources",
    "section": "",
    "text": "One of my favorite quotes"
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html#on-the-field-of-phylogenetics",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html#on-the-field-of-phylogenetics",
    "title": "Phylogenetic Resources",
    "section": "On the field of Phylogenetics:",
    "text": "On the field of Phylogenetics:\n\nLearning From Trees by Luke Harmon. An excellent book on learning the basics and theory in the field of phylogenetic comparative methods.\nPhylogenetic Comparative Methods in R by Liam Revell and Luke Harmon. An amazing R package that is constantly “evolving” and gaining new functions all the time. This package also makes plotting phylogenies wonderful\nThe Phytools Blog by Liam Revell An awesome way to learn more about working with the R package Phytools, in addition to keeping up to date with the new functions and tools\nDecoding Genomes: From Sequences to Phylodynamics by Tanja Stadler, Carsten Magnus, Timothy Vaughan, Joëlle Barido-Sottani, Veronika Bošková, Jana S. Huisman, Jūlija Pečerska. A recent book but from the intro chapters that I have read so far it is very approachable and informative. I love the idea of explaining the whole workflow.\nMolecular Evolution: A Statistical Approach by Ziheng Yang. This book is a deep dive into the work of phylogentic inference. I am using it to study for my Qualifying exams\nMolecular Evolution: A Phylogenetic Approach by Roderick D.M. Page and Edward C. Holmes. Another great book on phylogenetics. Plus it was written by Dr. Holmes who is was my friends original PI."
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html#at-the-intersection-of-bayesian-statistics-and-phylogenetics",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html#at-the-intersection-of-bayesian-statistics-and-phylogenetics",
    "title": "Phylogenetic Resources",
    "section": "At the intersection of Bayesian Statistics and Phylogenetics:",
    "text": "At the intersection of Bayesian Statistics and Phylogenetics:\n\n\n\nMy BEAST users where you at?\n\n\n\nBEAST Developed by Andrew Rambaut, Alexei Drummond, Daniel Ayres, Guy Baele, Philippe Lemey, and Marc Suchard. The Bayesian Evolutionary Analysis by Sampling Trees. A cross platform software for the Bayesian analysis of molecular sequences using MCMC. This website also has amazing tutorials*\nBEAST2 A rewrite of BEAST1 with some additional integration in the R environment.\nBEAST Book By Alexei J. Drummond and Remco R. Bouckaert. A excellent book on the foundations of phylogenetics using BEAST. It also includes information for developing the software itself.\nBAYESIAN PHYLOGENETICS Methods, Algorithms, and Applications Another great book I am working through now that digs into all things Bayesian and phylogenetics.\nBayes Rules by Alicia A. Johnson, Miles Q. Ott, Mine Dogucu. If you like tidyverse and want a different approach to learning Bayesian statistics then look no further. This is a great book\nStatistical Rethinking by Richard McElreath I just read this book as part of a advanced bio-statistics course. It does a fantastic job at introducing learners to the theory and practice of Bayesian statistics\nStatistical Rethinking Online Course I just found out that McElreath posts his lectures online. This is a great resource."
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html#on-plotting-and-other-tools",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html#on-plotting-and-other-tools",
    "title": "Phylogenetic Resources",
    "section": "On Plotting and Other tools:",
    "text": "On Plotting and Other tools:\n\nFigTree This software was designed originally to work with BEAST. It is very intuitive.\nData Integration, Manipulation, and Visualization of Phylogenetic Trees This was a lifesaver when I came across it. It uses the grammar of graphics we are used to with packages like ggplot and implements them into phylogenetic trees!"
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html#some-bonus-tools-and-books-for-coding",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html#some-bonus-tools-and-books-for-coding",
    "title": "Phylogenetic Resources",
    "section": "Some bonus tools and books for coding:",
    "text": "Some bonus tools and books for coding:\nThese books are not related to the above but are useful for learning purposes.\n\nR for Data Science This will teach you how to do data science in R and set you up well\nStatistics for Ecologists by John Fieberg. This book is a wonderful review of statistics with a focus on applications in Ecology. I highly recommend, also the author is a really cool person\nWhere Good Ideas Come From: The Natural History of Innovation I read portions of this book during the first year of my PhD. It changed the way I think about ideas and was very helpful."
  },
  {
    "objectID": "Blog_Posts/2024-06-27/2024-06-27.html#in-summary",
    "href": "Blog_Posts/2024-06-27/2024-06-27.html#in-summary",
    "title": "Phylogenetic Resources",
    "section": "In Summary:",
    "text": "In Summary:\nWell that is a lot of different things but I hope that you, my dear reader, might find something useful here. I hope that you can use these in your own scientific career or at the very least get a little peak into the wild world that is viral phylogenetics.\nSide Note: As you might be getting by now I am a little bit of a book dragon (I hoard books and then very slowly work my way through them lol).\nUntil next time keep your eyes to the sky.\nCheers,\nJonathan Dain\n\n\n\nOne of my favorite quotes\nMy BEAST users where you at?"
  },
  {
    "objectID": "Blog_Posts/2024-06-03/2024-06-03.html",
    "href": "Blog_Posts/2024-06-03/2024-06-03.html",
    "title": "It’s so fluffy I am gonna die!",
    "section": "",
    "text": "Watch your step little fluffballs present"
  },
  {
    "objectID": "Blog_Posts/2024-06-03/2024-06-03.html#another-trip-to-appledore-to-hold-chicks-count-me-in",
    "href": "Blog_Posts/2024-06-03/2024-06-03.html#another-trip-to-appledore-to-hold-chicks-count-me-in",
    "title": "It’s so fluffy I am gonna die!",
    "section": "Another trip to Appledore to hold chicks? COUNT ME IN!",
    "text": "Another trip to Appledore to hold chicks? COUNT ME IN!\nI am surrounded by adorable baby gulls, little balls of down wobbling and squawking. It is a sight to behold, but this much cuteness comes with a cost - extremely protective parents. Parents across the animal kingdom don’t enjoy their children getting picked up by anything other than themselves. Great Black Back Gulls are no exception. Moments after I picked up a exceptionally adorable lil munchkin I was sprayed across the back by something warm and wet. “Oh well it was time to change shirts anyway”, I thought as the fecal sample ran its way down my back. I brought the chick back to Kate who assisted me in taking a oral, cloacal swab, and a fecal sample from the chick. We repeated this process, me grabbing a chick, getting pooped on or swooped, and then sampling for each chick of the nest. Three chicks in this nest, a healthy clutch. It will be great to see them in a few weeks for the fledgling banding but that is another blog post (coming soon….).\nWhy are we handling these chicks in the first place? Well our purpose is two fold. If you have read any of the other articles on this blog you would not be surprised that we are looking for avian influenza. Part of my project is interested in the context a bird is in when it gets infected with avian influenza. These young chicks likely have maternal antibodies against influenza so infections are unlikely but if present would be very interesting to know.\nThat said our lab, the VirusPlusLab, is also beginning to work with non-virus microbes. We’re particularly interested in the “microvirome” – the collection of bacteria and viruses that live inside an animal. Understanding how the microvirome develops in young seabirds could provide insights into avian health and disease dynamics. Kate VanBrussel, our post-doctoral student, was just awarded a Healey Research Grant from UMass Boston to study this in detail.\nFor this study, we’re collecting samples from both adult gulls and their chicks. When an adult gull pooped on us (yes, this happens a lot in fieldwork!), we targeted their nest for later sampling. We affectionately called these the “PTP’s” – parents that pooped. We collected samples from 11 PTP nests, which will hopefully give us a unique look into the transfer of microbes from parent to offspring as well as early microvirome assembly in a unique seabird. In other words this is some pretty nifty stuff, and I am glad I get to be a small part of it. Even if that part serves as target practice for the angry parental gulls."
  },
  {
    "objectID": "Blog_Posts/2024-06-03/2024-06-03.html#the-cute-stuff",
    "href": "Blog_Posts/2024-06-03/2024-06-03.html#the-cute-stuff",
    "title": "It’s so fluffy I am gonna die!",
    "section": "The Cute Stuff:",
    "text": "The Cute Stuff:\nNow for the things that I am sure you all are waiting for. Cute pictures of baby gulls and stories from the island. To start here is a beautiful sunset photo I took that a gull photo bombed.\n\n\n\nGot photobombed by a gull\n\n\nOK now prepare yourself for a overload of cuteness. If you are not a gull lover you might become one after seeing their little faces. I have seen many a non-bird lover welcome a soft spot for these little guys.\n\n\n\n\n\n\n\n\n\nA GBBG chick. Look at those eyes\n\n\n\n\n\n\n\nSo fluffly\n\n\n\n\n\n\n\n\n\nA herring gull chick. Love the slight brown to the down\n\n\n\n\n\n\n\nThe whole clutch! Their mother gave me a “present”\n\n\n\n\n\n\n\n\n\nA bonus adult because he was majestic"
  },
  {
    "objectID": "Blog_Posts/2024-06-03/2024-06-03.html#some-stories",
    "href": "Blog_Posts/2024-06-03/2024-06-03.html#some-stories",
    "title": "It’s so fluffy I am gonna die!",
    "section": "Some stories:",
    "text": "Some stories:\nFieldwork can be challenging at times, which is highlighted especially if you are an individual who trips over things. Alas I am one such individual, and on this particular day I was walking down the path to “Grass Lab”, where we store our samples for the day and I happened to trip/twist my ankle. In the words of Kate I “looked like I was learning to walk in heals”. Thankfully I was wearing my thick boots so I didn’t manage to hurt it too badly but it was definitely sore the next day. The bright side of this stumble was Kate almost peeing her pants from laughing so hard.\nYou already heard about me getting covered in flying fecal matter from the mother of the three chicks above but we also had a hilarious - to us at least - incident with a herring gull. We had just finished sampling a set of three chicks which just could not stop pooping. Like each chick pooping three times kind of not stopping - a great sample by the way. Afterwards we watched this adult herring gull walk up near us. My colleague and I spoke to him saying “sir do you have some time to …” and before we could finish the words “poop for us” this gull proceeded to release a lovely sample and then simply walk away. This had us billowing with laughter as we collected the sample.\nFinally we have nest 20 which we waited a full week for the chicks to hatch. When they finally we leaped at the chance to sample the chicks. The parent gull had different plans. I am usually the grabber in our group so I waddled on up with a colleague armed with a gull stick - see here. The adult gull flushed off the nest and I grabbed the chicks, so far so good. However, rather than simply moving away the adult decided to fly up on to my head and try to stick it’s bill in the holes of my helmet. Thankfully it was not successful and soon flapped away. Nonetheless that is a memerable parent that I am looking forward to meeting again soon. If you want to see them you can check out figure 3 of this blog post.\nIn total, this was an amazing trip and I look forward to seeing these parents and chicks on the island again when I return for fledgling banding. The chicks will be much bigger and present a whole new adventure in gull wrangling for us.\nUntil then keep your eyes to the sky.\nCheers,\nJonathan Dain\n\n\n\nWatch your step little fluffballs present\nGot photobombed by a gull\nA GBBG chick. Look at those eyes\nSo fluffly\nA herring gull chick. Love the slight brown to the down\nThe whole clutch! Their mother gave me a “present”\nA bonus adult because he was majestic"
  }
]